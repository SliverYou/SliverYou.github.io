<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">



  
  
    
    
  <script src="/lib/pace/pace.min.js?v=1.0.2"></script>
  <link href="/lib/pace/pace-theme-minimal.min.css?v=1.0.2" rel="stylesheet">







<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />





  <script>
  (function(i,s,o,g,r,a,m){i["DaoVoiceObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;a.charset="utf-8";m.parentNode.insertBefore(a,m)})(window,document,"script",('https:' == document.location.protocol ? 'https:' : 'http:') + "//widget.daovoice.io/widget/0f81ff2f.js","daovoice")
  daovoice('init', {
      app_id: "96b9722f"
    });
  daovoice('update');
  </script>














  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/favicon.ico?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon.ico?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon.ico?v=5.1.3">


  <link rel="mask-icon" href="/images/favicon.ico?v=5.1.3" color="#222">





  <meta name="keywords" content="Python,Tips,Cryptography," />





  <link rel="alternate" href="/atom.xml" title="青柚" type="application/atom+xml" />






<meta name="description" content="“这是成为黑客的必经之路。”">
<meta name="keywords" content="Python,Tips,Cryptography">
<meta property="og:type" content="article">
<meta property="og:title" content="Python密码学不完全指北（古典密码）">
<meta property="og:url" content="http://home.junyouxiaowu.top/2018/03/05/Python密码学1/index.html">
<meta property="og:site_name" content="青柚">
<meta property="og:description" content="“这是成为黑客的必经之路。”">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="http://myblog-1256123790.cossh.myqcloud.com/img%E5%87%AF%E6%92%92%E5%8A%A0%E5%AF%86%E8%BD%AE%E7%9B%98.png">
<meta property="og:image" content="http://myblog-1256123790.cossh.myqcloud.com/img%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%8A%A0%E5%AF%86.png">
<meta property="og:image" content="http://myblog-1256123790.cossh.myqcloud.com/img%E9%A2%91%E5%BA%A6.png">
<meta property="og:image" content="http://myblog-1256123790.cossh.myqcloud.com/img%E9%A2%91%E7%8E%87%E5%AF%B9%E6%AF%94.jpg">
<meta property="og:updated_time" content="2018-03-31T07:31:10.683Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Python密码学不完全指北（古典密码）">
<meta name="twitter:description" content="“这是成为黑客的必经之路。”">
<meta name="twitter:image" content="http://myblog-1256123790.cossh.myqcloud.com/img%E5%87%AF%E6%92%92%E5%8A%A0%E5%AF%86%E8%BD%AE%E7%9B%98.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.3',
    sidebar: {"position":"right","display":"post","offset":12,"b2t":false,"scrollpercent":true,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://home.junyouxiaowu.top/2018/03/05/Python密码学1/"/>





  <title>Python密码学不完全指北（古典密码） | 青柚</title>
  









  <script type="text/javascript" src="http://cdn.webfont.youziku.com/wwwroot/js/wf/youziku.api.min.js"></script>
  <script type="text/javascript">
   /*$youziku.load(".site-subtitle", "da2dfc0362c0476da9190e4863da820d", "cyjianxk");*/
   $youziku.load(".site-title, .site-subtitle", "246f5245372643709946dcffbd31dfd1", "HanWangKaiMedium-Gb5");
   $youziku.draw();
</script>

</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-right page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">青柚</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">琴瑟在御 莫不静好</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-booklists">
          <a href="/booklists/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-book"></i> <br />
            
            书单
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            搜索
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="搜索..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://home.junyouxiaowu.top/2018/03/05/Python密码学1/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Sliver">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/assets/img/head.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="青柚">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">Python密码学不完全指北（古典密码）</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2018-03-05T20:39:27+08:00">
                2018-03-05
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/教程/" itemprop="url" rel="index">
                    <span itemprop="name">教程</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          
            <span class="post-meta-divider">|</span>
            <span class="page-pv"><i class="fa fa-file-o"></i> 阅读
            <span class="busuanzi-value" id="busuanzi_value_page_pv" ></span>
            </span>
          

          
            <div class="post-wordcount">
              
                
                <span class="post-meta-item-icon">
                  <i class="fa fa-file-word-o"></i>
                </span>
                
                  <span class="post-meta-item-text">字数统计&#58;</span>
                
                <span title="字数统计">
                  12,095
                </span>
              

              
                <span class="post-meta-divider">|</span>
              

              
                <span class="post-meta-item-icon">
                  <i class="fa fa-clock-o"></i>
                </span>
                
                  <span class="post-meta-item-text">阅读时长 &asymp;</span>
                
                <span title="阅读时长">
                  57
                </span>
              
            </div>
          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <blockquote class="blockquote-center"><p>“这是成为黑客的必经之路。”</p>
</blockquote>
<a id="more"></a>
<h2 id="什么是密码学？"><a href="#什么是密码学？" class="headerlink" title="什么是密码学？"></a>什么是密码学？</h2><p>密码学是一门非常古老的学科，是把人们能够读懂的消息变换成不易读懂的信息用来隐藏信息内容，使得窃听者无法理解消息的内容，同时又能够让合法用户把变换的结果还原成能够读懂的消息。</p>
<p>密码学的发展经历了3个阶段：<br>（1）古典密码。这个时期的密码应该被称之为艺术，而不是科学，是古代人民智慧的结晶，典型的密码有阴符、藏头诗、石蜡密信、反切密码（明代戚继光）、凯撒密码和天书等。<br>（2）近代密码。1949年，伟大科学家香农发表了著名的《保密系统的通信理论》和《通信的数学理论》两篇文章，使得密码学从此由艺术走上了科学的道路，成为一门学科。<br>（3）现代密码学。1976年，美国国家标准局公布了数据加密标准（DES），这一对称密码标准在世界上广泛流传和应用；同年，密码学家、图灵奖获得者Diffie和Hellman（2016年图灵奖）发表了《密码学的新方向》，开创了公钥密码学的新纪元。</p>
<p>下面就来说说一些古典加密法。</p>
<h2 id="凯撒加密法"><a href="#凯撒加密法" class="headerlink" title="凯撒加密法"></a>凯撒加密法</h2><blockquote>
<p>凯撒加密法，或称恺撒加密、恺撒变换、变换加密，是一种最简单且最广为人知的加密技术。它是一种替换加密的技术，明文中的所有字母都在字母表上向后（或向前）按照一个固定数目进行偏移后被替换成密文。</p>
</blockquote>
<p>其基本思想是：通过把字母移动一定的位数来实现加密和解密。例如，密钥代表的是把明文字母向后移动的位数。如果密钥为3，那么明文字母 B 就变成了密文的 E，依次类推，X 将变成 A，Y 变成 B，Z 变成 C。</p>
<p>也就是说，当密钥 <code>key = 3</code> 时，明文字母表和密文字母表分别是：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">明文字母表：ABCDEFGHIJKLMNOPQRSTUVWXYZ</div><div class="line">密文字母表：DEFGHIJKLMNOPQRSTUVWXYZABC</div></pre></td></tr></table></figure>
<p>使用时，加密者查找明文字母表中需要加密的消息中的每一个字母所在位置，并且写下密文字母表中对应的字母。需要解密的人则根据事先已知的密钥反过来操作，得到原来的明文。</p>
<p>那么，密钥有多少种可能呢？</p>
<p>有26个。因为当 <code>key = 26</code> 时，它的效果是和     <code>key = 0</code> 的效果是一样的，并且密文和明文的结果是一样的。</p>
<p>所以，通过穷举法，是可以轻松破解凯撒加密的。</p>
<p><img src="http://myblog-1256123790.cossh.myqcloud.com/img%E5%87%AF%E6%92%92%E5%8A%A0%E5%AF%86%E8%BD%AE%E7%9B%98.png" alt="凯撒加密"></p>
<p>根据凯撒加密法的原理，可以得到加解密算法的函数：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">from</span> pprint <span class="keyword">import</span> pprint</div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">LETTERS = string.ascii_uppercase  <span class="comment"># 获得二十六个英文大写字母</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CaesarCipher</span><span class="params">(message, key, mode)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 明文</span></div><div class="line"><span class="string">    key: 密钥（在0~25之间）</span></div><div class="line"><span class="string">    mode: 设定模式：加密（encrypt）；解密（decrypt）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    translated = <span class="string">''</span>  <span class="comment"># 翻译后字符串</span></div><div class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> message:</div><div class="line">        <span class="keyword">if</span> symbol.upper() <span class="keyword">in</span> LETTERS:</div><div class="line">            index = LETTERS.find(symbol.upper())</div><div class="line">            <span class="keyword">if</span> mode == <span class="string">'encrypt'</span>:  <span class="comment"># 判断当前是加密模式还是解密模式</span></div><div class="line">                index = (index + key) % len(LETTERS)</div><div class="line">            <span class="keyword">elif</span> mode == <span class="string">'decrypt'</span>:</div><div class="line">                index = (index - key) % len(LETTERS)</div><div class="line"></div><div class="line">            <span class="keyword">if</span> symbol.isupper():  <span class="comment"># 判断字符是大写还是小写，以此决定加密或解密后是大写还是小写</span></div><div class="line">                translated = translated + LETTERS[index]  <span class="comment"># 空字符串一个个加上翻译后得到的字符</span></div><div class="line">            <span class="keyword">elif</span> symbol.islower():</div><div class="line">                translated = translated + LETTERS[index].lower()</div><div class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果需要翻译的字符不在26个大写字母的范围内，就直接保持原样加入</span></div><div class="line">            translated = translated + symbol</div><div class="line">    <span class="keyword">return</span> translated</div><div class="line"></div><div class="line">print(CaesarCipher(<span class="string">'I love you.'</span>, <span class="number">13</span>, <span class="string">'encrypt'</span>))</div><div class="line">print(CaesarCipher(<span class="string">'V ybir lbh.'</span>, <span class="number">13</span>, <span class="string">'decrypt'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">V ybir lbh.</div><div class="line">I love you.</div></pre></td></tr></table></figure>
<p>因为加密密钥其实是知道的，根据所有的密钥对密文进行解密，得到的结果里肯定是包含正确的明文的：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">LETTERS = string.ascii_uppercase  <span class="comment"># 获得二十六个英文大写字母</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">CaesarCipherHacker</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''根据密文 message 和范围在 0~25 之间的密钥 key 实施暴力破解'''</span></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> range(len(LETTERS)):</div><div class="line">        translated = <span class="string">''</span>  <span class="comment"># 翻译后字符串</span></div><div class="line">        <span class="keyword">for</span> symbol <span class="keyword">in</span> message:</div><div class="line">            <span class="keyword">if</span> symbol.upper() <span class="keyword">in</span> LETTERS:</div><div class="line">                index = (LETTERS.find(symbol.upper()) - key) % len(LETTERS)</div><div class="line">                <span class="keyword">if</span> symbol.isupper():  <span class="comment"># 判断字符是大写还是小写，以此决定加密或解密后是大写还是小写</span></div><div class="line">                    translated = translated + LETTERS[index]  <span class="comment"># 空字符串一个个加上翻译后得到的字符</span></div><div class="line">                <span class="keyword">elif</span> symbol.islower():</div><div class="line">                    translated = translated + LETTERS[index].lower()</div><div class="line">            <span class="keyword">else</span>:  <span class="comment"># 如果需要翻译的字符不在26个大写字母的范围内</span></div><div class="line">                translated = translated + symbol</div><div class="line">        print(<span class="string">'&#123;:&gt;2&#125;: &#123;&#125;'</span>.format(key, translated))</div><div class="line"></div><div class="line">CaesarCipherHacker(<span class="string">'V ybir lbh.'</span>)</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"> <span class="number">0</span>: V ybir lbh.</div><div class="line"> <span class="number">1</span>: U xahq kag.</div><div class="line"> <span class="number">2</span>: T wzgp jzf.</div><div class="line"> <span class="number">3</span>: S vyfo iye.</div><div class="line"> <span class="number">4</span>: R uxen hxd.</div><div class="line"> <span class="number">5</span>: Q twdm gwc.</div><div class="line"> <span class="number">6</span>: P svcl fvb.</div><div class="line"> <span class="number">7</span>: O rubk eua.</div><div class="line"> <span class="number">8</span>: N qtaj dtz.</div><div class="line"> <span class="number">9</span>: M pszi csy.</div><div class="line"><span class="number">10</span>: L oryh brx.</div><div class="line"><span class="number">11</span>: K nqxg aqw.</div><div class="line"><span class="number">12</span>: J mpwf zpv.</div><div class="line"><span class="number">13</span>: I love you.</div><div class="line"><span class="number">14</span>: H knud xnt.</div><div class="line"><span class="number">15</span>: G jmtc wms.</div><div class="line"><span class="number">16</span>: F ilsb vlr.</div><div class="line"><span class="number">17</span>: E hkra ukq.</div><div class="line"><span class="number">18</span>: D gjqz tjp.</div><div class="line"><span class="number">19</span>: C fipy sio.</div><div class="line"><span class="number">20</span>: B ehox rhn.</div><div class="line"><span class="number">21</span>: A dgnw qgm.</div><div class="line"><span class="number">22</span>: Z cfmv pfl.</div><div class="line"><span class="number">23</span>: Y belu oek.</div><div class="line"><span class="number">24</span>: X adkt ndj.</div><div class="line"><span class="number">25</span>: W zcjs mci.</div></pre></td></tr></table></figure>
<p>可以得到，密钥为13的结果是正确的可读的明文。  </p>
<p>这里附上一个网页版的凯撒加密轮盘：<a href="https://inventwithpython.com/cipherwheel/" target="_blank" rel="external">CipherWheel</a></p>
<h2 id="维吉尼亚加密法"><a href="#维吉尼亚加密法" class="headerlink" title="维吉尼亚加密法"></a>维吉尼亚加密法</h2><blockquote>
<p>人们在单一恺撒密码的基础上扩展出多表密码，称为“维吉尼亚”密码。该方法最早记录在吉奥万·巴蒂斯塔·贝拉索（ Giovan Battista Bellaso）于1553年所著的书《吉奥万·巴蒂斯塔·贝拉索先生的密码》（意大利语：La cifra del. Sig. Giovan Battista Bellaso）中。</p>
</blockquote>
<p>所以说，虽然维吉尼亚加密法和凯撒加密法类似，但是维吉尼亚加密法拥有更多的密钥，所以也被称为多表替代加密法。而它的安全性，相较于其他古典加密法，是很高的，曾一度被称作 <code>不可破译的加密法</code>。</p>
<p><img src="http://myblog-1256123790.cossh.myqcloud.com/img%E7%BB%B4%E5%90%89%E5%B0%BC%E4%BA%9A%E5%8A%A0%E5%AF%86.png" alt="维吉尼亚加密方阵"></p>
<p>相比凯撒加密轮盘，维吉尼亚加密法形成的是一个巨大的方阵。</p>
<p>方阵用第一行代表明文字母，第一列代表密钥字母。它们包围的区域就是加密表，每一行都是不重复的26个字母，但下一行相对于上一行，会发生一次位移。</p>
<p>如果明文只用其中某一个进行加密，那么这就只是简单的恺撒加密法了。但如果用方阵中不同的行加密不同的字母，它就是一种强大的加密法了。</p>
<p>例如，加密者可以用第5行来加密第1个字母，再用第20行来加密第2个字母，然后根据第13行来加密第3个字母，不断选择不同的行，加密的程度也就越高。</p>
<p>我们可以根据上面的图对如下明文进行加密：<br><code>TO BE OR NOT TO BE THAT IS THE QUESTION</code><br>当选定 <code>RELATIONS</code> 作为密钥时，加密过程是：明文第一个字母为 T，密钥第一个字母为 R，因此可以得到 R 行 T 列的值为 K，将 T 换成 K。依此类推，得出对应关系如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">密钥：RELAT IONSR ELATI ONSRE LATIO NSREL</div><div class="line">明文：TOBEO RNOTT OBETH ATIST HEQUE STION</div><div class="line">密文：KSMEH ZBBLK SMEMP OGAJX SEJCS FLZSY</div></pre></td></tr></table></figure>
<p>现在可以用代码去实现了。</p>
<h3 id="使用维吉尼亚加密法对信息进行加密和解密"><a href="#使用维吉尼亚加密法对信息进行加密和解密" class="headerlink" title="使用维吉尼亚加密法对信息进行加密和解密"></a>使用维吉尼亚加密法对信息进行加密和解密</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># vigenereCipher.py</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">LETTERS = string.ascii_uppercase  <span class="comment"># 获得二十六个英文大写字母</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">Vigen</span>è<span class="title">reCipher</span><span class="params">(message, key, mode)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 明文</span></div><div class="line"><span class="string">    key: 密钥（不定长单词串）</span></div><div class="line"><span class="string">    mode: 设定模式：加密（encrypt）；解密（decrypt）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    translated = []  <span class="comment"># 翻译后字符串</span></div><div class="line">    keyIndex = <span class="number">0</span></div><div class="line">    key = key.upper()</div><div class="line"></div><div class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> message:</div><div class="line">        index = LETTERS.find(symbol.upper())</div><div class="line">        <span class="keyword">if</span> index != <span class="number">-1</span>:  <span class="comment"># 如果 index 等于 -1 代表 symbol 不在 LETTERS 中</span></div><div class="line">            <span class="keyword">if</span> mode == <span class="string">'encrypt'</span>:</div><div class="line">                index = (index + LETTERS.find(key[keyIndex])) % len(LETTERS)  <span class="comment"># 判断当前是加密模式还是解密模式</span></div><div class="line">            <span class="keyword">elif</span> mode == <span class="string">'decrypt'</span>:</div><div class="line">                index = (index - LETTERS.find(key[keyIndex])) % len(LETTERS)</div><div class="line"></div><div class="line">            <span class="comment"># 将翻译后的字符加入到 translated 列表</span></div><div class="line">            <span class="keyword">if</span> symbol.isupper():</div><div class="line">                translated.append(LETTERS[index])</div><div class="line">            <span class="keyword">elif</span> symbol.islower():</div><div class="line">                translated.append(LETTERS[index].lower())</div><div class="line"></div><div class="line">            keyIndex += <span class="number">1</span>  <span class="comment"># 不断移动密钥的索引，如果索引与密钥长度相等，就要重新置0</span></div><div class="line">            <span class="keyword">if</span> keyIndex == len(key):</div><div class="line">                keyIndex = <span class="number">0</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            translated.append(symbol)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(translated)  <span class="comment"># 将翻译后的字符组合成字符串</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vigen</span>è<span class="title">reEncrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="keyword">return</span> VigenèreCipher(message, key, <span class="string">'encrypt'</span>)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">vigen</span>è<span class="title">reDecrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="keyword">return</span> VigenèreCipher(message, key, <span class="string">'decrypt'</span>)</div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    print(vigenèreEncrypt(<span class="string">'Nothing is possible.'</span>, <span class="string">'Ariel'</span>))</div><div class="line">    print(vigenèreDecrypt(<span class="string">'Nfbltnx qw aojammlv.'</span>, <span class="string">'Ariel'</span>))</div><div class="line">    print(vigenèreEncrypt(<span class="string">'I have a lot of money.'</span>, <span class="string">'mathematics'</span>))</div><div class="line">    print(vigenèreDecrypt(<span class="string">'U htci m lhb qx yoglc.'</span>, <span class="string">'mathematics'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">Nfbltnx qw aojammlv.</div><div class="line">Nothing <span class="keyword">is</span> possible.</div><div class="line">U htci m lhb qx yoglc.</div><div class="line">I have a lot of money.</div></pre></td></tr></table></figure>
<h3 id="爆破维吉尼亚加密法"><a href="#爆破维吉尼亚加密法" class="headerlink" title="爆破维吉尼亚加密法"></a>爆破维吉尼亚加密法</h3><p>我们可以先来了解一下维吉尼亚加密法的背景：</p>
<blockquote>
<p>公元16世纪晚期，法国外交官维吉尼亚（Vigenere）提出著名的维吉尼亚方阵密表和维吉尼亚密码(Vigenerecypher)，这是一种多表加密的替代密码。Vigenere 密码的出现，使得先前对单表置换用的简单频率分析方法失效。<br>公元1863年，普鲁士少校卡西斯基（Kasiski）提出了 Kasiski 法，此方法从密钥的长度着手破解Vigenere 密码。</p>
</blockquote>
<ul>
<li>基本思想</li>
</ul>
<p>通常，用 <code>Vigenere</code> 密码加密，明文中的相同字母在密文中不会对应相同的字母。但是，如果两个相同字母序列间距正好是密钥长度的倍数时，也可能产生相同的密文序列。寻找重复出现的字母序列，并求其长度的过程被称为 <code>Kasiski</code> 试验，即 <code>Kasiski</code> 法。<br><code>Kasiski</code> 法 在解密 <code>Vigenere</code> 密码时，利用的是多表体系的弱点：相同的明文字母组，在明文序列中间隔的字母数为 d（d 是密钥的长度）的倍数时，则明文字母组对应的密文字母组也必相同。反之则不一定，但相同的概率很大。如果将密文中相同字母组找出来，并对其间隔的距离进行研究，找出它们的最大公因子，则该因子是密钥长度的概率是较大的。  </p>
<ul>
<li>基本原理</li>
</ul>
<p>基于 <code>Kasiski</code> 法的基本思想，<code>Kasiski</code> 法 测试过程如下：首先对密文中任意两个紧邻字符的出现位置进行统计，然后记下它们各次间出现的间隔。然后写出这些间隔对应数字的因数，最后对这些因数进行统计，一般来说，次数出现最多的几个因数极有可能就是密钥字符串的长度。其依据是：对于两个连续出现的字符在这次与下次出现的间隔极有可能是采用相同密钥加密形成的，从而这之间的间隔也极有可能就是密钥长度的倍数。<br>一般在使用 <code>Kasiski</code> 法测试密钥长度时，先搜索长度至少为3的相同的密文段，记录这些相同密文段到起始点之间的距离；假如得到如下几个距离 <code>X1,X2,...</code>，猜测密钥长度 <code>m</code> 为这些 <code>Xi</code> 的最大公因子的因子。</p>
<ul>
<li>分析步骤</li>
</ul>
<ol>
<li>在密文中标出重复的三个或多个字符序列；</li>
<li>对每一个字符序列，记下序列第一个字符的起始位置；</li>
<li>计算每个重复序列与第一个序列间的距离；</li>
<li>对每个距离求出所有因数有效的因数；</li>
<li>密钥的长度极有可能为步骤4中的出现次数较多的前面几位因数。</li>
</ol>
<p>知道如何得到密钥的长度后，还要了解一个现象：英文字母的频度。</p>
<p>英文中每个字母出现的频度并不都是一样的，曾有人对大量的英文书籍、文献和字典等做过统计，并汇总如下表：</p>
<p><img src="http://myblog-1256123790.cossh.myqcloud.com/img%E9%A2%91%E5%BA%A6.png" alt="英文频度"></p>
<p>可以看到，<code>ETAOIN</code> 是英文中出现频度最高的六个字母，而 <code>VKJXQZ</code> 则是出现频度最低的六个字母。</p>
<p>使用凯撒加密法或者维吉尼亚加密法时，都只是将原来的字母进行一定计算后再移位，替换成别的字母。原先的字母会变，但它们的频度不会变。明文加密后形成的密文，它的字母所拥有的频度，是与明文是差不多的。</p>
<p>给定一个文本：</p>
<blockquote>
<p>“I rc ascwuiluhnviwuetnh,osgaa ice tipeeeee slnatsfietgi tittynecenisl. e fo f fnc isltn sn o a yrs sd onisli ,l erglei trhfmwfrogotn,l  stcofiit.aea  wesn,lnc ee w,l eIh eeehoer ros  iol er snh nl oahsts  ilasvih  tvfeh rtira id thatnie.im ei-dlmf i  thszonsisehroe, aiehcdsanahiec  gv gyedsB affcahiecesd d lee   onsdihsoc nin cethiTitx  eRneahgin r e teom fbiotd  n  ntacscwevhtdhnhpiwru”</p>
</blockquote>
<p>我们统计一下这个文本中每个单词的频率，并对它进行从高到低排序：<code>EISNTHAOCLRFDGWVMUYBPZXQJK</code>。</p>
<p><img src="http://myblog-1256123790.cossh.myqcloud.com/img%E9%A2%91%E7%8E%87%E5%AF%B9%E6%AF%94.jpg" alt="频率对比"></p>
<p>将获得的排序好的字母和英文中出现频率从高到底的字母进行一一比较。我们可以看到：文本的字母频率表里的前六个字母，有四个在英文字母频率表的前六个字母里；文本的字母频率表里的后六个字母，有五个在英文字母频率表的后六个字母里。这意味着这个文本的字母出现频度很接近英文中的字母出现频度，我们定义这为<code>频率匹配分值</code>，而例子中的<code>频率匹配分值</code>应该为9。这意味着如果找对了密钥，通过密钥解密得到的明文，它会有较高的频率匹配分值。<br>再进一步想，知道密钥的长度后，从初始位置开始，每隔密钥长度取一个字母，组成一个字符串，我们用26个字母直接对这个字符串进行解密，如果得到的<code>频率匹配分值</code>较高，说明这个密钥可能包含这个字母。得到密钥每个位置可能拥有的字符后，排列组合一下密钥，轮番带入进行解密，就有可能找到正确的密钥了。整理一下思路，可以敲代码了。</p>
<p>为了完成爆破，我们需要先解决计算频率匹配分值的问题，可以创建一个 <code>freqAnalysis.py</code> 文件，里面写入：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># affineCipher.py</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> string</div><div class="line"></div><div class="line">englishLetterFreq = &#123;<span class="string">'E'</span>: <span class="number">12.70</span>, <span class="string">'T'</span>: <span class="number">9.06</span>, <span class="string">'A'</span>: <span class="number">8.17</span>, <span class="string">'O'</span>: <span class="number">7.51</span>, <span class="string">'I'</span>: <span class="number">6.97</span>, <span class="string">'N'</span>: <span class="number">6.75</span>, <span class="string">'S'</span>: <span class="number">6.33</span>, <span class="string">'H'</span>: <span class="number">6.09</span>, <span class="string">'R'</span>: <span class="number">5.99</span>, <span class="string">'D'</span>: <span class="number">4.25</span>, <span class="string">'L'</span>: <span class="number">4.03</span>, <span class="string">'C'</span>: <span class="number">2.78</span>, <span class="string">'U'</span>: <span class="number">2.76</span>, <span class="string">'M'</span>: <span class="number">2.41</span>, <span class="string">'W'</span>: <span class="number">2.36</span>, <span class="string">'F'</span>: <span class="number">2.23</span>, <span class="string">'G'</span>: <span class="number">2.02</span>, <span class="string">'Y'</span>: <span class="number">1.97</span>, <span class="string">'P'</span>: <span class="number">1.93</span>, <span class="string">'B'</span>: <span class="number">1.29</span>, <span class="string">'V'</span>: <span class="number">0.98</span>, <span class="string">'K'</span>: <span class="number">0.77</span>, <span class="string">'J'</span>: <span class="number">0.15</span>, <span class="string">'X'</span>: <span class="number">0.15</span>, <span class="string">'Q'</span>: <span class="number">0.10</span>, <span class="string">'Z'</span>: <span class="number">0.07</span>&#125;</div><div class="line">ETAOIN = <span class="string">'ETAOINSHRDLCUMWFGYPBVKJXQZ'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getLetterCount</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''根据给定的 message，计算每个英文字母出现的次数，并返回一个结构为 '字母：频度' 的字典'''</span></div><div class="line">    <span class="comment"># 初始化一个包含二十六个大写英文字母的字典，默认值为0</span></div><div class="line">    letterCount = dict.fromkeys(string.ascii_uppercase, <span class="number">0</span>)</div><div class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> message.upper():</div><div class="line">        <span class="keyword">if</span> letter <span class="keyword">in</span> letterCount:</div><div class="line">            letterCount[letter] += <span class="number">1</span>  <span class="comment"># 计数，相当于得到频度</span></div><div class="line">    <span class="keyword">return</span> letterCount</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getFrequencyOrder</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''根据给定的 message，计算每个英文字母出现的次数对英文字母进行排序，并返回包含频度从高到低的字母的字符串'''</span></div><div class="line">    letterToFreq = getLetterCount(message)</div><div class="line">    freqToLetter = &#123;&#125;</div><div class="line"></div><div class="line">    <span class="comment"># 创建键为频度，值为字母列表的字典，相同频度的字母在一个列表中</span></div><div class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> string.ascii_uppercase:</div><div class="line">        freqToLetter.setdefault(letterToFreq[letter], []).append(letter)</div><div class="line"></div><div class="line">    <span class="comment"># 将字母列表的值按照 ETAOIN 字符串内的字母顺序逆序排序，并合并成一个字符串</span></div><div class="line">    <span class="comment"># 为什么要逆序呢？比如 D 和 W 的频度都是1，因为英文字母中，D 出现的频度大于 W，现在在消息中 D 和 W 频度相等，也就代表 W 的频度其实更大一些，也就要排在 D 的前面</span></div><div class="line">    <span class="keyword">for</span> freq <span class="keyword">in</span> freqToLetter:</div><div class="line">        freqToLetter[freq].sort(key=ETAOIN.find, reverse=<span class="keyword">True</span>)</div><div class="line">        freqToLetter[freq] = <span class="string">''</span>.join(freqToLetter[freq])</div><div class="line"></div><div class="line">    <span class="comment"># 根据频度从大到小排序，并创建一个遵从这个顺序的字母列表</span></div><div class="line">    freqToLetter = sorted(freqToLetter.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>], reverse=<span class="keyword">True</span>)</div><div class="line">    freqOrder = [x[<span class="number">1</span>] <span class="keyword">for</span> x <span class="keyword">in</span> freqToLetter]</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(freqOrder)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">englishFreqMatchScore</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''计算频率匹配分值'''</span></div><div class="line">    freqOrder = getFrequencyOrder(message)</div><div class="line">    matchScore = <span class="number">0</span></div><div class="line"></div><div class="line">    <span class="comment"># 统计前六位字符和后六位字符与 ETAOIN 字符串的匹配程度</span></div><div class="line">    <span class="keyword">for</span> commonLetter <span class="keyword">in</span> ETAOIN[:<span class="number">6</span>]:</div><div class="line">        <span class="keyword">if</span> commonLetter <span class="keyword">in</span> freqOrder[:<span class="number">6</span>]:</div><div class="line">            matchScore += <span class="number">1</span></div><div class="line">    <span class="keyword">for</span> uncommonLetter <span class="keyword">in</span> ETAOIN[<span class="number">-6</span>:]:</div><div class="line">        <span class="keyword">if</span> uncommonLetter <span class="keyword">in</span> freqOrder[<span class="number">-6</span>:]:</div><div class="line">            matchScore += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="keyword">return</span> matchScore</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    message = <span class="string">'ddddbbbaaceeffj'</span></div><div class="line">    print(getLetterCount(message))</div><div class="line">    print(getFrequencyOrder(message))</div><div class="line">    print(englishFreqMatchScore(message))</div></pre></td></tr></table></figure>
<p>这样就搞定了频率分析的问题。<br>如果明文包含了大量的英文时，就有可能获得了正确的密钥。如果我们一个个看解密后的文字，费时劳神，可以通过字典文件，根据字符串是否在字典文件中判断它是不是英文。<br>请参考 <a href="https://files-1256123790.cos.ap-shanghai.myqcloud.com/detectEnglish.py" target="_blank" rel="external">detectEnglish.py</a> &amp; <a href="https://files-1256123790.cos.ap-shanghai.myqcloud.com/dictionary.txt" target="_blank" rel="external">dictionary.txt</a>。</p>
<p>完成了以上的准备工作，还要按照一开始的分析步骤，计算密钥的可能长度，创建密钥可能的字母组合，实施爆破。上代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div><div class="line">141</div><div class="line">142</div><div class="line">143</div><div class="line">144</div><div class="line">145</div><div class="line">146</div><div class="line">147</div><div class="line">148</div><div class="line">149</div><div class="line">150</div><div class="line">151</div><div class="line">152</div><div class="line">153</div><div class="line">154</div><div class="line">155</div><div class="line">156</div><div class="line">157</div><div class="line">158</div><div class="line">159</div><div class="line">160</div><div class="line">161</div><div class="line">162</div><div class="line">163</div><div class="line">164</div><div class="line">165</div><div class="line">166</div><div class="line">167</div><div class="line">168</div><div class="line">169</div><div class="line">170</div><div class="line">171</div><div class="line">172</div><div class="line">173</div><div class="line">174</div><div class="line">175</div><div class="line">176</div><div class="line">177</div><div class="line">178</div><div class="line">179</div><div class="line">180</div><div class="line">181</div><div class="line">182</div><div class="line">183</div><div class="line">184</div><div class="line">185</div><div class="line">186</div><div class="line">187</div><div class="line">188</div><div class="line">189</div><div class="line">190</div><div class="line">191</div><div class="line">192</div><div class="line">193</div><div class="line">194</div><div class="line">195</div><div class="line">196</div><div class="line">197</div><div class="line">198</div><div class="line">199</div><div class="line">200</div><div class="line">201</div><div class="line">202</div><div class="line">203</div><div class="line">204</div><div class="line">205</div><div class="line">206</div><div class="line">207</div><div class="line">208</div><div class="line">209</div><div class="line">210</div><div class="line">211</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># hacker.py</span></div><div class="line"></div><div class="line"><span class="keyword">import</span> itertools, re, string</div><div class="line"><span class="keyword">import</span> freqAnalysis, detectEnglish, vigenereCipher</div><div class="line"></div><div class="line">LETTERS = string.ascii_uppercase  <span class="comment"># 获得26个大写的英文字母</span></div><div class="line">NONLETTERS_PATTERN = re.compile(<span class="string">'[^A-Z]'</span>)  <span class="comment"># 预先编译去除大写字母外字符的模式</span></div><div class="line">MAX_KEY_LENGTH = <span class="number">16</span>  <span class="comment"># 设置可接受的最大的 key 的长度</span></div><div class="line">SILENT_MODE = <span class="keyword">False</span>  <span class="comment"># 静默模式，如果不想程序输出运行过程，就设置为 False</span></div><div class="line">NUM_MOST_FREQ_LETTERS = <span class="number">4</span>  <span class="comment"># 设定备选字符的长度</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">findRepeatSequencesSpacings</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''找到 message 中所有的长度为 3~6 的重复序列，并计算每个重复序列离最开始的序列的间距。'''</span></div><div class="line">    message = NONLETTERS_PATTERN.sub(<span class="string">''</span>, message.upper())</div><div class="line">    seqSpacings = &#123;&#125;</div><div class="line"></div><div class="line">    <span class="keyword">for</span> seqLen <span class="keyword">in</span> range(<span class="number">3</span>, <span class="number">6</span>):</div><div class="line">        <span class="keyword">for</span> seqStart <span class="keyword">in</span> range(len(message) - seqLen):</div><div class="line">            seq = message[seqStart:seqStart + seqLen]</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(seqStart + seqLen, len(message) - seqLen):</div><div class="line">                <span class="keyword">if</span> message[i:i + seqLen] == seq:</div><div class="line">                    seqSpacings.setdefault(seq, []).append(i - seqStart)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> seqSpacings</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getUsefulFactors</span><span class="params">(num)</span>:</span></div><div class="line">    <span class="string">'''返回有意义的因数。比如1是没有意义的，因数太大也是没有意义的。因为所求的因数是为了反映密钥的长度，如果太大，比如大于16，就很难再有效时间内完成后续的爆破。</span></div><div class="line"><span class="string">    比如 getUsefulFactors(144) 将会返回 [2, 72, 3, 48, 4, 36, 6, 24, 8, 18, 9, 16, 12]。</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    <span class="keyword">if</span> num &lt; <span class="number">2</span>:</div><div class="line">        <span class="keyword">return</span> []</div><div class="line">    factors = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">2</span>, MAX_KEY_LENGTH + <span class="number">1</span>):</div><div class="line">        <span class="keyword">if</span> num % i == <span class="number">0</span>:</div><div class="line">            factors.append(i)</div><div class="line">            factors.append(num // i)</div><div class="line">    <span class="keyword">if</span> <span class="number">1</span> <span class="keyword">in</span> factors:</div><div class="line">        factors.remove(<span class="number">1</span>)</div><div class="line">    <span class="keyword">return</span> list(set(factors))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getMostCommonFactors</span><span class="params">(seqFactors)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    seqFactors 是一个字典，它的键是重复序列, 值是因数列表。</span></div><div class="line"><span class="string">    比如 seqFactors = &#123;'GFD': [2, 3, 4, 6, 9, 12, 18, 23, 36, 46, 69, 92, 138, 207], 'ALW': [2, 3, 4, 6, ...], ...&#125;。</span></div><div class="line"><span class="string">    将返回一个包含因数和因数出现次数元组的列表。</span></div><div class="line"><span class="string">    '''</span> </div><div class="line">    factorCounts = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> seq <span class="keyword">in</span> seqFactors:</div><div class="line">        factorList = seqFactors[seq]</div><div class="line">        <span class="keyword">for</span> factor <span class="keyword">in</span> factorList:</div><div class="line">            <span class="keyword">if</span> factor <span class="keyword">not</span> <span class="keyword">in</span> factorCounts:</div><div class="line">                factorCounts[factor] = <span class="number">0</span></div><div class="line">            factorCounts[factor] += <span class="number">1</span></div><div class="line"></div><div class="line">    <span class="comment"># 筛选得到小于16的因数列表</span></div><div class="line">    factorsByCount = []</div><div class="line">    <span class="keyword">for</span> factor <span class="keyword">in</span> factorCounts:</div><div class="line">        <span class="keyword">if</span> factor &lt;= MAX_KEY_LENGTH:</div><div class="line">            <span class="comment"># factorsByCount 可能是包含这样值的列表：[(3, 497), (2, 487), ...]，即包含了 (factor, factorCount) 元组的列表</span></div><div class="line">            factorsByCount.append((factor, factorCounts[factor]))</div><div class="line">    </div><div class="line">    <span class="comment"># 根据因数出现的次数从大到小排序</span></div><div class="line">    factorsByCount.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> factorsByCount</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">kasiskiExamination</span><span class="params">(ciphertext)</span>:</span></div><div class="line">    <span class="string">'''卡西斯基试验法，根据重复序列和它们间隔的键值对，计算得到密钥有可能的长度。'''</span></div><div class="line">    <span class="comment"># 得到重复序列和其间隔的键值对</span></div><div class="line">    repeatedSeqSpacings = findRepeatSequencesSpacings(ciphertext)</div><div class="line">    </div><div class="line">    <span class="comment"># 获得重复序列间隔值的所有有效因数</span></div><div class="line">    seqFactors = &#123;&#125;</div><div class="line">    <span class="keyword">for</span> seq <span class="keyword">in</span> repeatedSeqSpacings:</div><div class="line">        seqFactors[seq] = []</div><div class="line">        <span class="keyword">for</span> spacing <span class="keyword">in</span> repeatedSeqSpacings[seq]:</div><div class="line">            seqFactors[seq].extend(getUsefulFactors(spacing))</div><div class="line"></div><div class="line">    <span class="comment"># 获得排序好的包含重复序列因数和其出现次数的列表</span></div><div class="line">    factorsByCount = getMostCommonFactors(seqFactors)</div><div class="line"></div><div class="line">    <span class="comment"># 获得包含 key 可能长度的列表  </span></div><div class="line">    allLikelyKeyLengths = [twoIntTuple[<span class="number">0</span>] <span class="keyword">for</span> twoIntTuple <span class="keyword">in</span> factorsByCount]</div><div class="line"></div><div class="line">    <span class="keyword">return</span> allLikelyKeyLengths</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getNthSubkeysLetters</span><span class="params">(n, keyLength, message)</span>:</span></div><div class="line">    <span class="string">'''从指定第 n 个位置开始，每隔 keyLength 长度，就取一个字符，直到遍历结束，返回取出的字符组合的字符串。</span></div><div class="line"><span class="string">    举例：</span></div><div class="line"><span class="string">    1. getNthSubkeysLetters(1, 3, 'ABCABCABC') returns 'AAA'</span></div><div class="line"><span class="string">    2. getNthSubkeysLetters(2, 3, 'ABCABCABC') returns 'BBB'</span></div><div class="line"><span class="string">    3. getNthSubkeysLetters(3, 3, 'ABCABCABC') returns 'CCC'</span></div><div class="line"><span class="string">    4. getNthSubkeysLetters(1, 5, 'ABCDEFGHI') returns 'AF'</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    message = NONLETTERS_PATTERN.sub(<span class="string">''</span>, message)</div><div class="line"></div><div class="line">    i = n - <span class="number">1</span></div><div class="line">    letters = []</div><div class="line">    <span class="keyword">while</span> i &lt; len(message):</div><div class="line">        letters.append(message[i])</div><div class="line">        i += keyLength</div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(letters)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">attemptHackWithKeyLength</span><span class="params">(ciphertext, mostLikelyKeyLength)</span>:</span></div><div class="line">    <span class="string">'''根据 key 可能的长度和计算好的 key 每一位可能包含的字符，对密文进行爆破'''</span></div><div class="line">    ciphertextUp = ciphertext.upper()</div><div class="line"></div><div class="line">    allFreqScores = []</div><div class="line">    <span class="keyword">for</span> nth <span class="keyword">in</span> range(<span class="number">1</span>, mostLikelyKeyLength + <span class="number">1</span>):</div><div class="line">        <span class="comment"># 获得间距为 mostLikelyKeyLength 的相邻字符组成的字符串</span></div><div class="line">        nthLetters = getNthSubkeysLetters(nth, mostLikelyKeyLength, ciphertextUp)</div><div class="line"></div><div class="line">        freqScores = []</div><div class="line">        <span class="keyword">for</span> possibleKey <span class="keyword">in</span> LETTERS:</div><div class="line">            <span class="comment"># 分别用二十六个字母对获得的字符串进行爆破并计算频率匹配分值</span></div><div class="line">            decryptedText = vigenereCipher.vigenèreDecrypt(nthLetters, possibleKey)</div><div class="line">            keyAndFreqMatchTuple = (possibleKey, freqAnalysis.englishFreqMatchScore(decryptedText))</div><div class="line"></div><div class="line">            <span class="comment"># freqScores 列表将会包含 mostLikelyKeyLength 个元组，元组包含了用于爆破的密钥和计算得到的频率匹配分值</span></div><div class="line">            freqScores.append(keyAndFreqMatchTuple)</div><div class="line"></div><div class="line">        <span class="comment"># 按照频率匹配分值进行从大到小排序</span></div><div class="line">        freqScores.sort(key=<span class="keyword">lambda</span> x: x[<span class="number">1</span>], reverse=<span class="keyword">True</span>)</div><div class="line"></div><div class="line">        allFreqScores.append(freqScores[:NUM_MOST_FREQ_LETTERS]) <span class="comment"># 只添加 freqScores 列表中排名前 NUM_MOST_FREQ_LETTERS 个元组，默认添加前四个</span></div><div class="line"></div><div class="line">    <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(len(allFreqScores)):</div><div class="line">            <span class="comment"># 输出密钥的字母可能是哪些，默认只有四个</span></div><div class="line">            print(<span class="string">'* Possible letters for letter &#123;&#125; of the key: '</span>.format(i + <span class="number">1</span>), end=<span class="string">''</span>)</div><div class="line">            <span class="keyword">for</span> freqScore <span class="keyword">in</span> allFreqScores[i]:</div><div class="line">                print(<span class="string">'&#123;&#125; '</span>.format(freqScore[<span class="number">0</span>]), end=<span class="string">''</span>)</div><div class="line">            print()</div><div class="line"></div><div class="line">    <span class="comment"># 创建密钥可能长度的各种字母组合</span></div><div class="line">    <span class="keyword">for</span> indexes <span class="keyword">in</span> itertools.product(range(NUM_MOST_FREQ_LETTERS), repeat=mostLikelyKeyLength):</div><div class="line">        <span class="comment"># 根据 allFreqScores 里的元素创建可能的密钥</span></div><div class="line">        possibleKey = <span class="string">''</span></div><div class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> range(mostLikelyKeyLength):</div><div class="line">            possibleKey += allFreqScores[i][indexes[i]][<span class="number">0</span>]</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">            print(<span class="string">'Attempting with key: &#123;&#125;'</span>.format(possibleKey))</div><div class="line"></div><div class="line">        decryptedText = vigenereCipher.vigenèreDecrypt(ciphertextUp, possibleKey)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> detectEnglish.isEnglish(decryptedText, wordPercentage=<span class="number">60</span>):</div><div class="line">            <span class="comment"># 根据原来输入的 ciphertext 来复原字母的大小写</span></div><div class="line">            origCase = []</div><div class="line">            <span class="keyword">for</span> i <span class="keyword">in</span> range(len(ciphertext)):</div><div class="line">                <span class="keyword">if</span> ciphertext[i].isupper():</div><div class="line">                    origCase.append(decryptedText[i].upper())</div><div class="line">                <span class="keyword">else</span>:</div><div class="line">                    origCase.append(decryptedText[i].lower())</div><div class="line">            decryptedText = <span class="string">''</span>.join(origCase)</div><div class="line"></div><div class="line">            <span class="comment"># 反馈给用户检查是否找到了正确的密钥</span></div><div class="line">            print(<span class="string">'&gt; Possible plaintext hack with key &#123;&#125;:'</span>.format(possibleKey))</div><div class="line">            print(<span class="string">'['</span>,decryptedText[:<span class="number">200</span>], <span class="string">']'</span>) <span class="comment"># only show first 200 characters</span></div><div class="line">            choice = input(<span class="string">'&gt; Enter (y)es for done, or press Enter for continue: '</span>)</div><div class="line">            <span class="keyword">if</span> choice == <span class="string">'y'</span> <span class="keyword">or</span> choice == <span class="string">'Y'</span> <span class="keyword">or</span> choice == <span class="string">'yes'</span>:</div><div class="line">                <span class="keyword">return</span> decryptedText</div><div class="line">            print()</div><div class="line"></div><div class="line">    <span class="comment"># 如果一直没有发现正确的密钥，说明爆破失败</span></div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hackVigenere</span><span class="params">(ciphertext)</span>:</span></div><div class="line">    <span class="string">'''试验卡西斯基试验法来爆破维吉尼亚加密法'''</span></div><div class="line">    allLikelyKeyLengths = kasiskiExamination(ciphertext)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> allLikelyKeyLengths:</div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">            keyLengthStr = <span class="string">' '</span>.join([ str(length) <span class="keyword">for</span> length <span class="keyword">in</span> allLikelyKeyLengths])</div><div class="line">            print(<span class="string">'Kasiski Examination results say the most likely key lengths are: '</span> + keyLengthStr)</div><div class="line"></div><div class="line">        <span class="keyword">for</span> keyLength <span class="keyword">in</span> allLikelyKeyLengths:</div><div class="line">            <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">                print(<span class="string">'\nAttempting hack with key length &#123;&#125; (&#123;&#125; possible keys)...'</span>.format(keyLength, NUM_MOST_FREQ_LETTERS ** keyLength))</div><div class="line">            hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</div><div class="line">            <span class="keyword">if</span> hackedMessage != <span class="keyword">None</span>:</div><div class="line">                <span class="keyword">break</span></div><div class="line"></div><div class="line">    <span class="keyword">elif</span> <span class="keyword">not</span> allLikelyKeyLengths <span class="keyword">or</span> hackedMessage == <span class="keyword">None</span>:</div><div class="line">    <span class="comment"># 如果卡西斯基试验法没有得到结果，就选择暴力破解</span></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">            print(<span class="string">'Unable to hack message with likely key length(s). Brute forcing key length...'</span>)</div><div class="line">        <span class="keyword">for</span> keyLength <span class="keyword">in</span> range(<span class="number">1</span>, MAX_KEY_LENGTH + <span class="number">1</span>):</div><div class="line">            <span class="keyword">if</span> keyLength <span class="keyword">not</span> <span class="keyword">in</span> allLikelyKeyLengths:</div><div class="line">                <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">                    print(<span class="string">'Attempting hack with key length &#123;&#125; (&#123;&#125; possible keys)...'</span>.format(keyLength, NUM_MOST_FREQ_LETTERS ** keyLength))</div><div class="line">                hackedMessage = attemptHackWithKeyLength(ciphertext, keyLength)</div><div class="line">                <span class="keyword">if</span> hackedMessage != <span class="keyword">None</span>:</div><div class="line">                    <span class="keyword">break</span></div><div class="line">    <span class="keyword">return</span> hackedMessage</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">(message)</span>:</span></div><div class="line">    hackedMessage = hackVigenere(message)</div><div class="line"></div><div class="line">    <span class="keyword">if</span> hackedMessage != <span class="keyword">None</span>:</div><div class="line">        print()</div><div class="line">        print(hackedMessage)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        print(<span class="string">'Failed to hack.'</span>)</div><div class="line"></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    message1 = <span class="string">"""Adiz Avtzqeci Tmzubb wsa m Pmilqev halpqavtakuoi, lgouqdaf, kdmktsvmztsl, izr xoexghzr kkusitaaf. Vz wsa twbhdg ubalmmzhdad qz hce vmhsgohuqbo ox kaakulmd gxiwvos, krgdurdny i rcmmstugvtawz ca tzm ocicwxfg jf "stscmilpy" oid "uwydptsbuci" wabt hce Lcdwig eiovdnw. Bgfdny qe kddwtk qjnkqpsmev ba pz tzm roohwz at xoexghzr kkusicw izr vrlqrwxist uboedtuuznum. Pimifo Icmlv Emf DI, Lcdwig owdyzd xwd hce Ywhsmnemzh Xovm mby Cqxtsm Supacg (GUKE) oo Bdmfqclwg Bomk, Tzuhvif'a ocyetzqofifo ositjm. Rcm a lqys ce oie vzav wr Vpt 8, lpq gzclqab mekxabnittq tjr Ymdavn fihog cjgbhvnstkgds. Zm psqikmp o iuejqf jf lmoviiicqg aoj jdsvkavs Uzreiz qdpzmdg, dnutgrdny bts helpar jf lpq pjmtm, mb zlwkffjmwktoiiuix avczqzs ohsb ocplv nuby swbfwigk naf ohw Mzwbms umqcifm. Mtoej bts raj pq kjrcmp oo tzm Zooigvmz Khqauqvl Dincmalwdm, rhwzq vz cjmmhzd gvq ca tzm rwmsl lqgdgfa rcm a kbafzd-hzaumae kaakulmd, hce SKQ. Wi 1948 Tmzubb jgqzsy Msf Zsrmsv'e Qjmhcfwig Dincmalwdm vt Eizqcekbqf Pnadqfnilg, ivzrw pq onsaafsy if bts yenmxckmwvf ca tzm Yoiczmehzr uwydptwze oid tmoohe avfsmekbqr dn eifvzmsbuqvl tqazjgq. Pq kmolm m dvpwz ab ohw ktshiuix pvsaa at hojxtcbefmewn, afl bfzdakfsy okkuzgalqzu xhwuuqvl jmmqoigve gpcz ie hce Tmxcpsgd-Lvvbgbubnkq zqoxtawz, kciup isme xqdgo otaqfqev qz hce 1960k. Bgfdny'a tchokmjivlabk fzsmtfsy if i ofdmavmz krgaqqptawz wi 1952, wzmz vjmgaqlpad iohn wwzq goidt uzgeyix wi tzm Gbdtwl Wwigvwy. Vz aukqdoev bdsvtemzh rilp rshadm tcmmgvqg (xhwuuqvl uiehmalqab) vs sv mzoejvmhdvw ba dmikwz. Hpravs rdev qz 1954, xpsl whsm tow iszkk jqtjrw pug 42id tqdhcdsg, rfjm ugmbddw xawnofqzu. Vn avcizsl lqhzreqzsy tzif vds vmmhc wsa eidcalq; vds ewfvzr svp gjmw wfvzrk jqzdenmp vds vmmhc wsa mqxivmzhvl. Gv 10 Esktwunsm 2009, fgtxcrifo mb Dnlmdbzt uiydviyv, Nfdtaat Dmiem Ywiikbqf Bojlab Wrgez avdw iz cafakuog pmjxwx ahwxcby gv nscadn at ohw Jdwoikp scqejvysit xwd "hce sxboglavs kvy zm ion tjmmhzd." Sa at Haq 2012 i bfdvsbq azmtmd'g widt ion bwnafz tzm Tcpsw wr Zjrva ivdcz eaigd yzmbo Tmzubb a kbmhptgzk dvrvwz wa efiohzd."""</span></div><div class="line">    message2 = <span class="string">"""Ej xvvvfea riiw azzwjmcqik dw ew wi r hcmhiu syl witgxm v hfuewm (pzcp bcid) kz Q byvkd Q rej lcgdrx lz iktvsdm olve. Mco ek lsm nedw eqhi, Z ola yijhpzvxvdj zpreayo varq qzjq kzpu vru lsmdv vezbdsesw iwyjw. T evw mwcg xsexwqxxvv lvy lrv yw dhvs hpvx Z olvoiu lz lj azls ut pzxp. Q ceu swevcj wikzpcwo qi qrls iih jg T kcsjw ew kyikfm olrl. T ldhe'l vvja zl lb olv ltuz, fll xg qiiq dmiwv gq azpw-ozzol nsd jvwvv zv olv xlko xyse Q rej yzwy ek elbc."""</span></div><div class="line">    main(message1)</div><div class="line">    <span class="comment">#main(message2)</span></div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div></pre></td><td class="code"><pre><div class="line">Kasiski Examination results say the most likely key lengths are: <span class="number">3</span> <span class="number">2</span> <span class="number">6</span> <span class="number">4</span> <span class="number">12</span> <span class="number">8</span> <span class="number">9</span> <span class="number">16</span> <span class="number">5</span> <span class="number">11</span> <span class="number">10</span> <span class="number">15</span> <span class="number">7</span> <span class="number">14</span> <span class="number">13</span></div><div class="line"></div><div class="line">Attempting hack <span class="keyword">with</span> key length <span class="number">3</span> (<span class="number">64</span> possible keys)...</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">1</span> of the key: A L M E</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">2</span> of the key: S N O C</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">3</span> of the key: V I Z B</div><div class="line">Attempting <span class="keyword">with</span> key: ASV</div><div class="line">Attempting <span class="keyword">with</span> key: ASI</div><div class="line">Attempting <span class="keyword">with</span> key: ASZ</div><div class="line">Attempting <span class="keyword">with</span> key: ASB</div><div class="line">Attempting <span class="keyword">with</span> key: ANV</div><div class="line">Attempting <span class="keyword">with</span> key: ANI</div><div class="line">Attempting <span class="keyword">with</span> key: ANZ</div><div class="line">Attempting <span class="keyword">with</span> key: ANB</div><div class="line">Attempting <span class="keyword">with</span> key: AOV</div><div class="line">Attempting <span class="keyword">with</span> key: AOI</div><div class="line">Attempting <span class="keyword">with</span> key: AOZ</div><div class="line">Attempting <span class="keyword">with</span> key: AOB</div><div class="line">Attempting <span class="keyword">with</span> key: ACV</div><div class="line">Attempting <span class="keyword">with</span> key: ACI</div><div class="line">Attempting <span class="keyword">with</span> key: ACZ</div><div class="line">Attempting <span class="keyword">with</span> key: ACB</div><div class="line">Attempting <span class="keyword">with</span> key: LSV</div><div class="line">Attempting <span class="keyword">with</span> key: LSI</div><div class="line">Attempting <span class="keyword">with</span> key: LSZ</div><div class="line">Attempting <span class="keyword">with</span> key: LSB</div><div class="line">Attempting <span class="keyword">with</span> key: LNV</div><div class="line">Attempting <span class="keyword">with</span> key: LNI</div><div class="line">Attempting <span class="keyword">with</span> key: LNZ</div><div class="line">Attempting <span class="keyword">with</span> key: LNB</div><div class="line">Attempting <span class="keyword">with</span> key: LOV</div><div class="line">Attempting <span class="keyword">with</span> key: LOI</div><div class="line">Attempting <span class="keyword">with</span> key: LOZ</div><div class="line">Attempting <span class="keyword">with</span> key: LOB</div><div class="line">Attempting <span class="keyword">with</span> key: LCV</div><div class="line">Attempting <span class="keyword">with</span> key: LCI</div><div class="line">Attempting <span class="keyword">with</span> key: LCZ</div><div class="line">Attempting <span class="keyword">with</span> key: LCB</div><div class="line">Attempting <span class="keyword">with</span> key: MSV</div><div class="line">Attempting <span class="keyword">with</span> key: MSI</div><div class="line">Attempting <span class="keyword">with</span> key: MSZ</div><div class="line">Attempting <span class="keyword">with</span> key: MSB</div><div class="line">Attempting <span class="keyword">with</span> key: MNV</div><div class="line">Attempting <span class="keyword">with</span> key: MNI</div><div class="line">Attempting <span class="keyword">with</span> key: MNZ</div><div class="line">Attempting <span class="keyword">with</span> key: MNB</div><div class="line">Attempting <span class="keyword">with</span> key: MOV</div><div class="line">Attempting <span class="keyword">with</span> key: MOI</div><div class="line">Attempting <span class="keyword">with</span> key: MOZ</div><div class="line">Attempting <span class="keyword">with</span> key: MOB</div><div class="line">Attempting <span class="keyword">with</span> key: MCV</div><div class="line">Attempting <span class="keyword">with</span> key: MCI</div><div class="line">Attempting <span class="keyword">with</span> key: MCZ</div><div class="line">Attempting <span class="keyword">with</span> key: MCB</div><div class="line">Attempting <span class="keyword">with</span> key: ESV</div><div class="line">Attempting <span class="keyword">with</span> key: ESI</div><div class="line">Attempting <span class="keyword">with</span> key: ESZ</div><div class="line">Attempting <span class="keyword">with</span> key: ESB</div><div class="line">Attempting <span class="keyword">with</span> key: ENV</div><div class="line">Attempting <span class="keyword">with</span> key: ENI</div><div class="line">Attempting <span class="keyword">with</span> key: ENZ</div><div class="line">Attempting <span class="keyword">with</span> key: ENB</div><div class="line">Attempting <span class="keyword">with</span> key: EOV</div><div class="line">Attempting <span class="keyword">with</span> key: EOI</div><div class="line">Attempting <span class="keyword">with</span> key: EOZ</div><div class="line">Attempting <span class="keyword">with</span> key: EOB</div><div class="line">Attempting <span class="keyword">with</span> key: ECV</div><div class="line">Attempting <span class="keyword">with</span> key: ECI</div><div class="line">Attempting <span class="keyword">with</span> key: ECZ</div><div class="line">Attempting <span class="keyword">with</span> key: ECB</div><div class="line"></div><div class="line">Attempting hack <span class="keyword">with</span> key length <span class="number">2</span> (<span class="number">16</span> possible keys)...</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">1</span> of the key: O A E Z</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">2</span> of the key: M S I D</div><div class="line">Attempting <span class="keyword">with</span> key: OM</div><div class="line">Attempting <span class="keyword">with</span> key: OS</div><div class="line">Attempting <span class="keyword">with</span> key: OI</div><div class="line">Attempting <span class="keyword">with</span> key: OD</div><div class="line">Attempting <span class="keyword">with</span> key: AM</div><div class="line">Attempting <span class="keyword">with</span> key: AS</div><div class="line">Attempting <span class="keyword">with</span> key: AI</div><div class="line">Attempting <span class="keyword">with</span> key: AD</div><div class="line">Attempting <span class="keyword">with</span> key: EM</div><div class="line">Attempting <span class="keyword">with</span> key: ES</div><div class="line">Attempting <span class="keyword">with</span> key: EI</div><div class="line">Attempting <span class="keyword">with</span> key: ED</div><div class="line">Attempting <span class="keyword">with</span> key: ZM</div><div class="line">Attempting <span class="keyword">with</span> key: ZS</div><div class="line">Attempting <span class="keyword">with</span> key: ZI</div><div class="line">Attempting <span class="keyword">with</span> key: ZD</div><div class="line"></div><div class="line">Attempting hack <span class="keyword">with</span> key length <span class="number">6</span> (<span class="number">4096</span> possible keys)...</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">1</span> of the key: A E O P</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">2</span> of the key: S D G H</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">3</span> of the key: I V X B</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">4</span> of the key: M Z Q A</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">5</span> of the key: O B Z A</div><div class="line">* Possible letters <span class="keyword">for</span> letter <span class="number">6</span> of the key: V I K Z</div><div class="line">Attempting <span class="keyword">with</span> key: ASIMOV</div><div class="line">&gt; Possible plaintext hack <span class="keyword">with</span> key ASIMOV:</div><div class="line">[ Alan Mathison Turing was a British mathematician, logician, cryptanalyst, <span class="keyword">and</span> computer scientist. He was highly influential <span class="keyword">in</span> the development of computer science, providing a formalisationof the con ]</div><div class="line">&gt; Enter (y)es <span class="keyword">for</span> done, <span class="keyword">or</span> press Enter <span class="keyword">for</span> <span class="keyword">continue</span>: y</div><div class="line"></div><div class="line">Alan Mathison Turing was a British mathematician, logician, cryptanalyst, <span class="keyword">and</span> computer scientist. He was highly influential <span class="keyword">in</span> the development of computer science, providing a formalisation of the concepts of <span class="string">"algorithm"</span> <span class="keyword">and</span> <span class="string">"computation"</span> <span class="keyword">with</span> the Turing machine. Turing <span class="keyword">is</span> widely considered to be the father of computer science <span class="keyword">and</span> artificial intelligence. During World War II, Turing worked <span class="keyword">for</span> the Government Code <span class="keyword">and</span> Cypher School (GCCS) at Bletchley Park, Britain<span class="string">'s codebreaking centre. For a time he was head of Hut 8, the section responsible for German naval cryptanalysis. He devised a number of techniques for breaking German ciphers, including the method of the bombe, an electromechanical machine that could find settings for the Enigma machine. After the war he worked at the National Physical Laboratory, where he created one of the first designs for a stored-program computer, the ACE. In 1948 Turing joined Max Newman'</span>s Computing Laboratory at Manchester University, where he assisted <span class="keyword">in</span> the development of the Manchester computers <span class="keyword">and</span> became interested <span class="keyword">in</span> mathematical biology. He wrote a paper on the chemical basis of morphogenesis, <span class="keyword">and</span> predicted oscillating chemical reactions such <span class="keyword">as</span> the Belousov-Zhabotinsky reaction, which were first observed <span class="keyword">in</span> the <span class="number">1960</span>s. Turing<span class="string">'s homosexuality resulted in a criminal prosecution in 1952, when homosexual acts were still illegal in the United Kingdom. He accepted treatment with female hormones (chemical castration) as an alternative to prison. Turing died in 1954, just over two weeks before his 42nd birthday, from cyanide poisoning. An inquest determined that his death was suicide; his mother and some others believed his death was accidental. On 10 September 2009,following an Internet campaign, British Prime Minister Gordon Brown made an official public apology on behalf of the British government for "the appalling way he was treated." As of May 2012 a private member'</span>s bill was before the House of Lords which would grant Turing a statutory pardon <span class="keyword">if</span> enacted.</div></pre></td></tr></table></figure>
<h2 id="仿射加密法"><a href="#仿射加密法" class="headerlink" title="仿射加密法"></a>仿射加密法</h2><p>仿射加密法类似凯撒加密法，只是它将凯撒加密中的加法改成了乘法和加法的结合。仿射加密中的加密和解密算法为：</p>
<p><code>C = Ek(m) = (k1 × m + k2) mod n</code><br><code>M = Dk(c) = k3(c - k2) mod n</code>，其中 <code>(k3 × k1) mod 26 = 1</code>。</p>
<p>仿射加密具有可逆性的条件是 <code>gcd(k1, n) = 1</code>。当 <code>k1 = 1</code> 时，仿射加密就变为了加法加密也就是凯撒加密，当 <code>k2 = 0</code> 时，仿射密码变为了乘法加密。这两种情况带来的加密效果都是较弱的，所以应尽量避免。</p>
<p>仿射加密中的密钥空间的大小为 <code>n·φ(n)</code>。当 n 为26个英文字母时，<code>φ(n) = 12</code>，因此仿射加密的密钥空间为 <code>12 × 26 = 312</code>。</p>
<p>因为其加密和解密大部分思路与凯撒加密、维吉尼亚加密相同，所以直接附上源代码。算法较难点就是求最大公因数的欧几里得除法和求模逆的拓展欧几里得除法，内容颇多，请参考度娘。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> sys</div><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> random</div><div class="line"></div><div class="line"><span class="comment">#LETTERS = """ !"#$%&amp;'()*+,-./0123456789:;&lt;=&gt;?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\]^_`abcdefghijklmnopqrstuvwxyz&#123;|&#125;~""" # note the space at the front</span></div><div class="line">LETTERS = <span class="string">'ABCDEFGHIJKLMNOPQRSTUVWXYZ'</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">modInverse</span><span class="params">(a, m)</span>:</span></div><div class="line">    <span class="string">'''返回a的逆，使 a * a^-1 = 1 mod(m)'''</span></div><div class="line">    <span class="keyword">if</span> math.gcd(a, m) != <span class="number">1</span>:  <span class="comment"># 如果不 a 和 m 不互质，则 a^-1 不存在</span></div><div class="line">        <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line">    <span class="comment"># 欧几里得拓展除法</span></div><div class="line">    u1, u2, u3 = <span class="number">1</span>, <span class="number">0</span>, a</div><div class="line">    v1, v2, v3 = <span class="number">0</span>, <span class="number">1</span>, m</div><div class="line">    <span class="keyword">while</span> v3 != <span class="number">0</span>:</div><div class="line">        q = u3 // v3</div><div class="line">        v1, v2, v3, u1, u2, u3 = (u1 - q * v1), (u2 - q * v2), (u3 - q * v3), v1, v2, v3</div><div class="line">    <span class="keyword">return</span> u1 % m</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getRandomKey</span><span class="params">()</span>:</span></div><div class="line">    <span class="string">'''生成一个随机的 key，其中 key = keyA * len(LETTERS) + keyB，且 keyA 和 len(LETTERS) 要互质'''</span></div><div class="line">    <span class="keyword">while</span> <span class="keyword">True</span>:</div><div class="line">        keyA = random.randint(<span class="number">2</span>, len(LETTERS))</div><div class="line">        keyB = random.randint(<span class="number">2</span>, len(LETTERS))</div><div class="line">        <span class="keyword">if</span> math.gcd(keyA, len(LETTERS)) == <span class="number">1</span>:</div><div class="line">            key = keyA * len(LETTERS) + keyB</div><div class="line">            print(<span class="string">'Generate key:'</span>, key)</div><div class="line">            <span class="keyword">return</span> key</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">getKeyParts</span><span class="params">(key)</span>:</span></div><div class="line">    <span class="string">'''将给定的 key 分解成 keyA 和 keyB 两个 key'''</span></div><div class="line">    keyA, keyB = key // len(LETTERS), key % len(LETTERS)</div><div class="line">    <span class="keyword">return</span> (keyA, keyB)</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">checkKeys</span><span class="params">(keyA, keyB, mode)</span>:</span></div><div class="line">    <span class="string">'''检查 keyA 和 keyB 是否符合标准'''</span></div><div class="line">    <span class="keyword">if</span> keyA == <span class="number">1</span> <span class="keyword">and</span> mode == <span class="string">'encrypt'</span>:</div><div class="line">        sys.exit(<span class="string">'The affine cipher becomes incredibly weak when key A is set to 1. Choose a different key.'</span>)</div><div class="line">    <span class="keyword">if</span> keyB == <span class="number">0</span> <span class="keyword">and</span> mode == <span class="string">'encrypt'</span>:</div><div class="line">        sys.exit(<span class="string">'The affine cipher becomes incredibly weak when key B is set to 0. Choose a different key.'</span>)</div><div class="line">    <span class="keyword">if</span> keyA &lt; <span class="number">0</span> <span class="keyword">or</span> keyB &lt; <span class="number">0</span> <span class="keyword">or</span> keyB &gt; len(LETTERS) - <span class="number">1</span>:</div><div class="line">        sys.exit(<span class="string">'Key A must be greater than 0 and Key B must be between 0 and %s.'</span> % (len(LETTERS) - <span class="number">1</span>))</div><div class="line">    <span class="keyword">if</span> math.gcd(keyA, len(LETTERS)) != <span class="number">1</span>:</div><div class="line">        sys.exit(<span class="string">'Key A (%s) and the letter set size (%s) are not relatively prime. Choose a different key.'</span> % (keyA, len(LETTERS)))</div><div class="line">    </div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">AffineEncrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''对信息用仿射加密法进行加密'''</span></div><div class="line">    keyA, keyB = getKeyParts(key)</div><div class="line">    checkKeys(keyA, keyB, <span class="string">'encrypt'</span>)</div><div class="line">    ciphertext = <span class="string">''</span></div><div class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> message:</div><div class="line">        <span class="keyword">if</span> letter.upper() <span class="keyword">in</span> LETTERS:</div><div class="line">            index = LETTERS.find(letter.upper())</div><div class="line">            <span class="keyword">if</span> letter.isupper():</div><div class="line">                ciphertext += LETTERS[(index * keyA + keyB) % len(LETTERS)]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                ciphertext += LETTERS[(index * keyA + keyB) % len(LETTERS)].lower()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            ciphertext += letter</div><div class="line">    <span class="keyword">return</span> ciphertext</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">AffineDecrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''对信息用仿射加密法进行解密'''</span></div><div class="line">    keyA, keyB = getKeyParts(key)</div><div class="line">    checkKeys(keyA, keyB, <span class="string">'decrypt'</span>)</div><div class="line">    plaintext = <span class="string">''</span></div><div class="line">    modInverseOfKeyA = modInverse(keyA, len(LETTERS))</div><div class="line">    <span class="keyword">for</span> letter <span class="keyword">in</span> message:</div><div class="line">        <span class="keyword">if</span> letter.upper() <span class="keyword">in</span> LETTERS:</div><div class="line">            index = LETTERS.find(letter.upper())</div><div class="line">            <span class="keyword">if</span> letter.isupper():</div><div class="line">                plaintext += LETTERS[(index - keyB) * modInverseOfKeyA % len(LETTERS)]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                plaintext += LETTERS[(index - keyB) * modInverseOfKeyA % len(LETTERS)].lower()</div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            plaintext += letter</div><div class="line">    <span class="keyword">return</span> plaintext    </div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    message = <span class="string">'Every human being is intended to have a character of his own; to be what no others are, and to do what no other can do.'</span></div><div class="line">    key = getRandomKey()</div><div class="line">    ciphertext = AffineEncrypt(message, key)</div><div class="line">    print(ciphertext)</div><div class="line">    plaintext = AffineDecrypt(ciphertext, key)</div><div class="line">    print(plaintext)</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">Generate key: <span class="number">142</span></div><div class="line">Gngtc viumz rgazq ay azdgzbgb de vmng m wvmtmwdgt el vay esz; de rg svmd ze edvgty mtg, mzb de be svmd ze edvgt wmz be.</div><div class="line">Every human being <span class="keyword">is</span> intended to have a character of his own; to be what no others are, <span class="keyword">and</span> to do what no other can do.</div></pre></td></tr></table></figure>
<p>对仿射加密法，我们可以实施爆破，因为它实际的密钥数量并不多，带入每个可能的密钥进行解密，并判断解密后的字符串是否为准确的英文，如果是，就有可能是找到了正确的密钥。</p>
<p>所以，需要导入一个英文字典，根据字符是否在英文字典中，可以判断这个字符是不是英文字母。因为可能会有误差，所以需要设定误差的取值范围。</p>
<p>具体实现可以参考我的源码：<a href="https://files-1256123790.cos.ap-shanghai.myqcloud.com/detectEnglish.py" target="_blank" rel="external">detectEnglish.py</a> &amp; <a href="https://files-1256123790.cos.ap-shanghai.myqcloud.com/dictionary.txt" target="_blank" rel="external">dictionary.txt</a></p>
<p>根据上面的思路，我们可以实施爆破：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> math</div><div class="line"><span class="keyword">import</span> affineCipher</div><div class="line"><span class="keyword">import</span> detectEnglish</div><div class="line"></div><div class="line">SILENT_MODE = <span class="keyword">False</span></div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">hackAffine</span><span class="params">(message)</span>:</span></div><div class="line">    print(<span class="string">'Hacking...'</span>)</div><div class="line"></div><div class="line">    <span class="keyword">for</span> key <span class="keyword">in</span> range(len(affineCipher.LETTERS) ** <span class="number">2</span>):</div><div class="line">        keyA = affineCipher.getKeyParts(key)[<span class="number">0</span>]</div><div class="line"></div><div class="line">        <span class="keyword">if</span> math.gcd(keyA, len(affineCipher.LETTERS)) != <span class="number">1</span>:</div><div class="line">            <span class="keyword">continue</span></div><div class="line"></div><div class="line">        decryptedText = affineCipher.AffineDecrypt(message, key)</div><div class="line"></div><div class="line">        <span class="keyword">if</span> <span class="keyword">not</span> SILENT_MODE:</div><div class="line">            print(<span class="string">'Trying key &#123;&#125;... [&#123;&#125;]'</span>.format(key, decryptedText[:<span class="number">40</span>]))</div><div class="line"></div><div class="line">        <span class="keyword">if</span> detectEnglish.isEnglish(decryptedText):</div><div class="line">            print(<span class="string">'\nPossible plaintext:'</span>)</div><div class="line">            print(<span class="string">'Key: %s'</span> % (key))</div><div class="line">            print(<span class="string">'Plaintext: \n'</span> + decryptedText[:<span class="number">200</span>])</div><div class="line">            choice = input(<span class="string">'Enter (y)es for done, or press Enter for continue: '</span>)</div><div class="line">            <span class="keyword">if</span> choice == <span class="string">'y'</span> <span class="keyword">or</span> choice == <span class="string">'Y'</span>:</div><div class="line">                <span class="keyword">return</span> decryptedText</div><div class="line">            print()</div><div class="line">    <span class="keyword">return</span> <span class="keyword">None</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</div><div class="line">    message = <span class="string">'Qfqda lyuob vqsbe sk sbrqbjqj ri lofq o clodocrqd ix lsk imb; ri vq mlor bi irlqdk odq, obj ri ji mlor bi irlqd cob ji.'</span></div><div class="line">    hackAffine(message)</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div></pre></td><td class="code"><pre><div class="line">Hacking...</div><div class="line">Trying key <span class="number">26.</span>.. [Qfqda lyuob vqsbe sk sbrqbjqj ri lofq o ]</div><div class="line">Trying key <span class="number">27.</span>.. [Pepcz kxtna uprad rj raqpaipi qh knep n ]</div><div class="line">Trying key <span class="number">28.</span>.. [Odoby jwsmz toqzc qi qzpozhoh pg jmdo m ]</div><div class="line">Trying key <span class="number">29.</span>.. [Ncnax ivrly snpyb ph pyonygng of ilcn l ]</div><div class="line">Trying key <span class="number">30.</span>.. [Mbmzw huqkx rmoxa og oxnmxfmf ne hkbm k ]</div><div class="line">Trying key <span class="number">31.</span>.. [Lalyv gtpjw qlnwz nf nwmlwele md gjal j ]</div><div class="line">Trying key <span class="number">32.</span>.. [Kzkxu fsoiv pkmvy me mvlkvdkd lc fizk i ]</div><div class="line">Trying key <span class="number">33.</span>.. [Jyjwt ernhu ojlux ld lukjucjc kb ehyj h ]</div><div class="line">Trying key <span class="number">34.</span>.. [Ixivs dqmgt niktw kc ktjitbib ja dgxi g ]</div><div class="line">Trying key <span class="number">35.</span>.. [Hwhur cplfs mhjsv jb jsihsaha iz cfwh f ]</div><div class="line">Trying key <span class="number">36.</span>.. [Gvgtq boker lgiru ia irhgrzgz hy bevg e ]</div><div class="line">Trying key <span class="number">37.</span>.. [Fufsp anjdq kfhqt hz hqgfqyfy gx aduf d ]</div><div class="line">Trying key <span class="number">38.</span>.. [Etero zmicp jegps gy gpfepxex fw zcte c ]</div><div class="line">Trying key <span class="number">39.</span>.. [Dsdqn ylhbo idfor fx foedowdw ev ybsd b ]</div><div class="line">Trying key <span class="number">40.</span>.. [Crcpm xkgan hcenq ew endcnvcv du xarc a ]</div><div class="line">Trying key <span class="number">41.</span>.. [Bqbol wjfzm gbdmp dv dmcbmubu ct wzqb z ]</div><div class="line">Trying key <span class="number">42.</span>.. [Apank vieyl faclo cu clbaltat bs vypa y ]</div><div class="line">Trying key <span class="number">43.</span>.. [Zozmj uhdxk ezbkn bt bkazkszs ar uxoz x ]</div><div class="line">Trying key <span class="number">44.</span>.. [Ynyli tgcwj dyajm <span class="keyword">as</span> ajzyjryr zq twny w ]</div><div class="line">Trying key <span class="number">45.</span>.. [Xmxkh sfbvi cxzil zr ziyxiqxq yp svmx v ]</div><div class="line">Trying key <span class="number">46.</span>.. [Wlwjg reauh bwyhk yq yhxwhpwp xo rulw u ]</div><div class="line">Trying key <span class="number">47.</span>.. [Vkvif qdztg avxgj xp xgwvgovo wn qtkv t ]</div><div class="line">Trying key <span class="number">48.</span>.. [Ujuhe pcysf zuwfi wo wfvufnun vm psju s ]</div><div class="line">Trying key <span class="number">49.</span>.. [Titgd obxre ytveh vn veutemtm ul orit r ]</div><div class="line">Trying key <span class="number">50.</span>.. [Shsfc nawqd xsudg um udtsdlsl tk nqhs q ]</div><div class="line">Trying key <span class="number">51.</span>.. [Rgreb mzvpc wrtcf tl tcsrckrk sj mpgr p ]</div><div class="line">Trying key <span class="number">78.</span>.. [Otoba viywj hogjk gm gjxojdod xu vwto w ]</div><div class="line">Trying key <span class="number">79.</span>.. [Fkfsr mzpna yfxab xd xaofaufu ol mnkf n ]</div><div class="line">Trying key <span class="number">80.</span>.. [Wbwji dqger pwors ou orfwrlwl fc debw e ]</div><div class="line">Trying key <span class="number">81.</span>.. [Nsnaz uhxvi gnfij fl fiwnicnc wt uvsn v ]</div><div class="line">Trying key <span class="number">82.</span>.. [Ejerq lyomz xewza wc wzneztet nk lmje m ]</div><div class="line">Trying key <span class="number">83.</span>.. [Vavih cpfdq ovnqr nt nqevqkvk eb cdav d ]</div><div class="line">Trying key <span class="number">84.</span>.. [Mrmzy tgwuh fmehi ek ehvmhbmb vs turm u ]</div><div class="line">Trying key <span class="number">85.</span>.. [Didqp kxnly wdvyz vb vymdysds mj klid l ]</div><div class="line">Trying key <span class="number">86.</span>.. [Uzuhg boecp numpq ms mpdupjuj da bczu c ]</div><div class="line">Trying key <span class="number">87.</span>.. [Lqlyx sfvtg eldgh dj dgulgala ur stql t ]</div><div class="line">Trying key <span class="number">88.</span>.. [Chcpo jwmkx vcuxy ua uxlcxrcr li jkhc k ]</div><div class="line">Trying key <span class="number">89.</span>.. [Tytgf andbo mtlop lr loctoiti cz abyt b ]</div><div class="line">Trying key <span class="number">90.</span>.. [Kpkxw reusf dkcfg ci cftkfzkz tq rspk s ]</div><div class="line">Trying key <span class="number">91.</span>.. [Bgbon ivljw ubtwx tz twkbwqbq kh ijgb j ]</div><div class="line">Trying key <span class="number">92.</span>.. [Sxsfe zmcan lskno kq knbsnhsh by zaxs a ]</div><div class="line">Trying key <span class="number">93.</span>.. [Jojwv qdtre cjbef bh besjeyjy sp qroj r ]</div><div class="line">Trying key <span class="number">94.</span>.. [Afanm hukiv tasvw sy svjavpap jg hifa i ]</div><div class="line">Trying key <span class="number">95.</span>.. [Rwred ylbzm krjmn jp jmarmgrg ax yzwr z ]</div><div class="line">Trying key <span class="number">96.</span>.. [Inivu pcsqd biade ag adridxix ro pqni q ]</div><div class="line">Trying key <span class="number">97.</span>.. [Zezml gtjhu szruv rx ruizuozo <span class="keyword">if</span> ghez h ]</div><div class="line">Trying key <span class="number">98.</span>.. [Qvqdc xkayl jqilm io ilzqlfqf zw xyvq y ]</div><div class="line">Trying key <span class="number">99.</span>.. [Hmhut obrpc ahzcd zf zcqhcwhw qn opmh p ]</div><div class="line">Trying key <span class="number">100.</span>.. [Ydylk fsigt ryqtu qw qthytnyn he fgdy g ]</div><div class="line">Trying key <span class="number">101.</span>.. [Pupcb wjzxk iphkl hn hkypkepe yv wxup x ]</div><div class="line">Trying key <span class="number">102.</span>.. [Glgts naqob zgybc ye ybpgbvgv pm nolg o ]</div><div class="line">Trying key <span class="number">103.</span>.. [Xcxkj erhfs qxpst pv psgxsmxm gd efcx f ]</div><div class="line">Trying key <span class="number">130.</span>.. [Ybyla xkeiv zyovg oc ovtyvhyh tm xiby i ]</div><div class="line">Trying key <span class="number">131.</span>.. [Dgdqf cpjna edtal th taydamdm yr cngd n ]</div><div class="line">Trying key <span class="number">132.</span>.. [Ilivk huosf jiyfq ym yfdifrir dw hsli s ]</div><div class="line">Trying key <span class="number">133.</span>.. [Nqnap mztxk ondkv dr dkinkwnw ib mxqn x ]</div><div class="line">Trying key <span class="number">134.</span>.. [Svsfu reycp tsipa iw ipnspbsb ng rcvs c ]</div><div class="line">Trying key <span class="number">135.</span>.. [Xaxkz wjdhu yxnuf nb nusxugxg sl whax h ]</div><div class="line">Trying key <span class="number">136.</span>.. [Cfcpe boimz dcszk sg szxczlcl xq bmfc m ]</div><div class="line">Trying key <span class="number">137.</span>.. [Hkhuj gtnre ihxep xl xecheqhq cv grkh r ]</div><div class="line">Trying key <span class="number">138.</span>.. [Mpmzo lyswj nmcju cq cjhmjvmv ha lwpm w ]</div><div class="line">Trying key <span class="number">139.</span>.. [Ruret qdxbo srhoz hv homroara mf qbur b ]</div><div class="line">Trying key <span class="number">140.</span>.. [Wzwjy vicgt xwmte ma mtrwtfwf rk vgzw g ]</div><div class="line">Trying key <span class="number">141.</span>.. [Bebod anhly cbryj rf rywbykbk wp aleb l ]</div><div class="line">Trying key <span class="number">142.</span>.. [Gjgti fsmqd hgwdo wk wdbgdpgp bu fqjg q ]</div><div class="line">Trying key <span class="number">143.</span>.. [Lolyn kxrvi mlbit bp bigliulu gz kvol v ]</div><div class="line">Trying key <span class="number">144.</span>.. [Qtqds pcwan rqgny gu gnlqnzqz le patq a ]</div><div class="line">Trying key <span class="number">145.</span>.. [Vyvix uhbfs wvlsd lz lsqvseve qj ufyv f ]</div><div class="line">Trying key <span class="number">146.</span>.. [Adanc zmgkx baqxi qe qxvaxjaj vo zkda k ]</div><div class="line">Trying key <span class="number">147.</span>.. [Fifsh erlpc gfvcn vj vcafcofo at epif p ]</div><div class="line">Trying key <span class="number">148.</span>.. [Knkxm jwquh lkahs ao ahfkhtkt fy junk u ]</div><div class="line">Trying key <span class="number">149.</span>.. [Pspcr obvzm qpfmx ft fmkpmypy kd ozsp z ]</div><div class="line">Trying key <span class="number">150.</span>.. [Uxuhw tgaer vukrc ky krpurdud pi texu e ]</div><div class="line">Trying key <span class="number">151.</span>.. [Zczmb ylfjw azpwh pd pwuzwizi un yjcz j ]</div><div class="line">Trying key <span class="number">152.</span>.. [Eherg dqkob feubm ui ubzebnen zs dohe o ]</div><div class="line">Trying key <span class="number">153.</span>.. [Jmjwl ivptg kjzgr zn zgejgsjs ex itmj t ]</div><div class="line">Trying key <span class="number">154.</span>.. [Orobq nauyl poelw es eljolxox jc nyro y ]</div><div class="line">Trying key <span class="number">155.</span>.. [Twtgv sfzdq utjqb jx jqotqctc oh sdwt d ]</div><div class="line">Trying key <span class="number">182.</span>.. [Gxgta jwocp dgkpi ku kpvgpfgf vq jcxg c ]</div><div class="line">Trying key <span class="number">183.</span>.. [Rirel uhzna orvat vf vagraqrq gb unir n ]</div><div class="line">Trying key <span class="number">184.</span>.. [Ctcpw fskyl zcgle gq glrclbcb rm fytc y ]</div><div class="line">Trying key <span class="number">185.</span>.. [Nenah qdvjw knrwp rb rwcnwmnm cx qjen j ]</div><div class="line">Trying key <span class="number">186.</span>.. [Ypyls boguh vycha cm chnyhxyx ni bupy u ]</div><div class="line">Trying key <span class="number">187.</span>.. [Jajwd mzrfs gjnsl nx nsyjsiji yt mfaj f ]</div><div class="line">Trying key <span class="number">188.</span>.. [Uluho xkcqd ruydw yi ydjudtut je xqlu q ]</div><div class="line">Trying key <span class="number">189.</span>.. [Fwfsz ivnbo cfjoh jt joufoefe up ibwf b ]</div><div class="line">Trying key <span class="number">190.</span>.. [Qhqdk tgymz nquzs ue uzfqzpqp fa tmhq m ]</div><div class="line">Trying key <span class="number">191.</span>.. [Bsbov erjxk ybfkd fp fkqbkaba ql exsb x ]</div><div class="line">Trying key <span class="number">192.</span>.. [Mdmzg pcuiv jmqvo qa qvbmvlml bw pidm i ]</div><div class="line">Trying key <span class="number">193.</span>.. [Xoxkr anftg uxbgz bl bgmxgwxw mh atox t ]</div><div class="line">Trying key <span class="number">194.</span>.. [Izivc lyqer fimrk mw mrxirhih xs lezi e ]</div><div class="line">Trying key <span class="number">195.</span>.. [Tktgn wjbpc qtxcv xh xcitcsts id wpkt p ]</div><div class="line">Trying key <span class="number">196.</span>.. [Every human being <span class="keyword">is</span> intended to have a ]</div><div class="line"></div><div class="line">Possible plaintext:</div><div class="line">Key: <span class="number">196</span></div><div class="line">Plaintext:</div><div class="line">Every human being <span class="keyword">is</span> intended to have a character of his own; to be what no others are, <span class="keyword">and</span> to do what no other can do.</div><div class="line">Enter (y)es <span class="keyword">for</span> done, <span class="keyword">or</span> press Enter <span class="keyword">for</span> <span class="keyword">continue</span>: y</div></pre></td></tr></table></figure>
<p>轻松爆破。所以可以得到：仿射加密法，其实也是很不安全的。</p>
<h2 id="Playfair-加密法"><a href="#Playfair-加密法" class="headerlink" title="Playfair 加密法"></a>Playfair 加密法</h2><blockquote>
<p>Playfair密码（英文：Playfair cipher 或 Playfair square）是一种使用一个关键词方格来加密字符对的加密法，1854年由查尔斯·惠斯通（Charles Wheatstone）的英国人发明。</p>
</blockquote>
<p>它有一些不太明显的特征：</p>
<ul>
<li>密文的字母数一定是偶数。</li>
<li>任意两个同组的字母都不会相同，如果出现这种字符必是乱码和虚码。 </li>
</ul>
<p>因为它使用方便而且可以让频度分析法变成瞎子，所以在1854到1855年的克里米亚战争和1899年的布尔战争中有广泛应用。但在1915年的一战中被破译了。  </p>
<p>Playfair 加密法编写分三步：</p>
<ol>
<li>编制密码表 </li>
<li>整理明文 </li>
<li>编写密文（构成部分：1.密钥 2.明文 3.密文）</li>
</ol>
<h3 id="加密"><a href="#加密" class="headerlink" title="加密"></a>加密</h3><h4 id="编制密码表"><a href="#编制密码表" class="headerlink" title="编制密码表"></a>编制密码表</h4><p>第一步是编制密码表。在这个 <code>5 * 5</code> 的密码表中，共有5行5列字母。第一行（或第一列）是密钥，其余按照字母顺序。密钥是一个单词或词组，若有重复字母，可将后面重复的字母去掉。当然也要把使用频率最少的字母去掉。并且，如果密钥同时包含 <code>I</code> 和 <code>J</code>，可以将密钥中的 <code>J</code> 替换成 <code>I</code> 或者将密码表填充的时候去掉 <code>Q</code>。如：密钥是 <code>Live and learn</code>，格式化后则为 <code>liveandr</code>。如果密钥过长可占用第二行或列。<br>如密钥 <code>crazy dog</code>，可编制成：</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">C</td>
<td style="text-align:center">R</td>
<td style="text-align:center">A</td>
<td style="text-align:center">Z</td>
<td style="text-align:center">Y</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">D</td>
<td style="text-align:center">O</td>
<td style="text-align:center">G</td>
<td style="text-align:center">B</td>
<td style="text-align:center">E</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">F</td>
<td style="text-align:center">H</td>
<td style="text-align:center">I \ J</td>
<td style="text-align:center">K</td>
<td style="text-align:center">L</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">M</td>
<td style="text-align:center">N</td>
<td style="text-align:center">P</td>
<td style="text-align:center">Q</td>
<td style="text-align:center">S</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">T</td>
<td style="text-align:center">U</td>
<td style="text-align:center">V</td>
<td style="text-align:center">W</td>
<td style="text-align:center">X</td>
</tr>
</tbody>
</table>
<p>或</p>
<table>
<thead>
<tr>
<th style="text-align:center"></th>
<th style="text-align:center">0</th>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">0</td>
<td style="text-align:center">C</td>
<td style="text-align:center">D</td>
<td style="text-align:center">F</td>
<td style="text-align:center">M</td>
<td style="text-align:center">T</td>
</tr>
<tr>
<td style="text-align:center">1</td>
<td style="text-align:center">R</td>
<td style="text-align:center">O</td>
<td style="text-align:center">H</td>
<td style="text-align:center">N</td>
<td style="text-align:center">U</td>
</tr>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">A</td>
<td style="text-align:center">G</td>
<td style="text-align:center">I \ J</td>
<td style="text-align:center">P</td>
<td style="text-align:center">V</td>
</tr>
<tr>
<td style="text-align:center">3</td>
<td style="text-align:center">Z</td>
<td style="text-align:center">B</td>
<td style="text-align:center">K</td>
<td style="text-align:center">Q</td>
<td style="text-align:center">W</td>
</tr>
<tr>
<td style="text-align:center">4</td>
<td style="text-align:center">Y</td>
<td style="text-align:center">E</td>
<td style="text-align:center">L</td>
<td style="text-align:center">S</td>
<td style="text-align:center">X</td>
</tr>
</tbody>
</table>
<p>大部分资料使用的是第一种填充方式，所以这里选择第一种。</p>
<h4 id="整理明文"><a href="#整理明文" class="headerlink" title="整理明文"></a>整理明文</h4><p>第二步是整理明文。将明文每两个字母组成一组。如果出现两个相同的字母，则在第一个字母后添加 <code>X</code> 构成一组，第二个相同的字母与它后面的字母构成一组；如果只剩下最后一个字母，则在其后添加 <code>X</code> 构成一组。当然，也可以将 <code>X</code> 换成其它字母（比如 <code>Q</code>）。<br>如 <code>communist</code>，应整理成 <code>CO MX MU NI ST</code>；<code>balloon</code> 应整理成 <code>BA LX LO ON</code>。</p>
<h4 id="编写密文"><a href="#编写密文" class="headerlink" title="编写密文"></a>编写密文</h4><p>加密规则：</p>
<ol>
<li>每两个整理好的明文字符进行加密。</li>
<li>同行不同列：依次取右边一位。</li>
<li>同列不同行：依次取下边一位。</li>
<li>不同行且不同列：依次取对角线横向一位。</li>
</ol>
<p>如，依照第一个表，明文 <code>Where there is life, there is hope.</code>  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">可先整理为：WH ER ET HE RE IS LI FE TH ER EI SH OP EX  </div><div class="line">然后密文为：UK OY DX LO YO LP FK LD UF OY GL NL GN LY</div></pre></td></tr></table></figure>
<h3 id="解密"><a href="#解密" class="headerlink" title="解密"></a>解密</h3><p>解密规则：</p>
<ol>
<li>同行不同列：依次取左边一位。</li>
<li>同列不同行：依次取上边一位。</li>
<li>不同行且不同列：依次取对角线竖向一位。</li>
</ol>
<p>根据以上思路，可以用 Python 去实现加解密算法：</p>
<ul>
<li>编制密码表</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">removeDuplicate</span><span class="params">(key, dup=<span class="number">0</span>)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    将 key 中的非字母字符和重复字符删去并返回一个新的 key 字符串</span></div><div class="line"><span class="string">    key: 需要格式化的密钥</span></div><div class="line"><span class="string">    dup: 代表密钥选择的格式化方法：将 I 和 J 都视为 I（dup=0）;将 I 和 J 视为两个字符，选择在填充密码表的时候去除 Q，</span></div><div class="line"><span class="string">    但是要确保密钥中不包含 Q，否则还是按照第一种格式化方法（dup=1)</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    key = key.upper()</div><div class="line">    <span class="keyword">if</span> dup == <span class="number">0</span>:  <span class="comment"># 根据格式化方法对 key 进行初步格式化</span></div><div class="line">        key = key.replace(<span class="string">'J'</span>, <span class="string">'I'</span>)</div><div class="line">    <span class="keyword">else</span>:</div><div class="line">        <span class="keyword">if</span> <span class="string">'Q'</span> <span class="keyword">in</span> key:</div><div class="line">            key = key.replace(<span class="string">'J'</span>, <span class="string">'I'</span>)</div><div class="line">    s, newKey= set(), list()  <span class="comment"># 建立一个过滤集合和 newKey 列表</span></div><div class="line">    temp = [ char <span class="keyword">for</span> char <span class="keyword">in</span> key <span class="keyword">if</span> char.isalpha() ]  <span class="comment"># 去除非字母符号并将字母大写</span></div><div class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> temp:  <span class="comment"># 根据哈希表的原理查询当前字符是否已经存在</span></div><div class="line">        <span class="keyword">if</span> char <span class="keyword">not</span> <span class="keyword">in</span> s:</div><div class="line">            newKey.append(char)</div><div class="line">            s.add(char)</div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(newKey)  <span class="comment"># 整理成字符串</span></div><div class="line">    </div><div class="line">print(removeDuplicate(<span class="string">'Crazy dog'</span>))</div><div class="line">print(removeDuplicate(<span class="string">'Live and learn'</span>))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">createTable</span><span class="params">(key, dup=<span class="number">0</span>)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    根据格式化后的 newKey 建立密码表</span></div><div class="line"><span class="string">    key: 需要格式化的密钥</span></div><div class="line"><span class="string">    dup: 代表密钥选择的格式化方法：将 I 和 J 都视为 I（dup=0）;将 I 和 J 视为两个字符，选择在填充密码表的时候去除 Q，</span></div><div class="line"><span class="string">    但是要确保密钥中不包含 Q，否则还是按照第一种格式化方法（dup=1)</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    newKey = removeDuplicate(key, dup)  <span class="comment"># 返回格式化后的 key</span></div><div class="line">    letters = <span class="string">'ABCDEFGHIKLMNOPQRSTUVWXYZ'</span> <span class="keyword">if</span> dup == <span class="number">0</span> <span class="keyword">or</span> <span class="string">'Q'</span> <span class="keyword">in</span> newKey <span class="keyword">else</span> <span class="string">'ABCDEFGHIJKLMNOPRSTUVWXYZ'</span>  <span class="comment"># 根据格式化方法整理 letters</span></div><div class="line">    passwordTable = []</div><div class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">25</span>):</div><div class="line">        <span class="keyword">if</span> i &lt; len(newKey):</div><div class="line">            passwordTable.append(newKey[i])  <span class="comment"># 填充 newKey</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            <span class="keyword">for</span> char <span class="keyword">in</span> letters:</div><div class="line">                <span class="keyword">if</span> char <span class="keyword">not</span> <span class="keyword">in</span> passwordTable:</div><div class="line">                    passwordTable.append(char)  <span class="comment"># 填充不在密码表中的英文字母</span></div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="comment"># return list(map(list, zip(*([iter(passwordTable)] * 5))))  # 将一维列表转化为二维列表</span></div><div class="line">    <span class="keyword">return</span> passwordTable</div><div class="line"></div><div class="line">print(createTable(<span class="string">'Crazy dog'</span>))</div><div class="line">print(createTable(<span class="string">'Live and learn'</span>))</div><div class="line">print(createTable(<span class="string">'Sliver'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">CRAZYDOG</div><div class="line">LIVEANDR</div><div class="line"></div><div class="line">[<span class="string">'C'</span>, <span class="string">'R'</span>, <span class="string">'A'</span>, <span class="string">'Z'</span>, <span class="string">'Y'</span>, <span class="string">'D'</span>, <span class="string">'O'</span>, <span class="string">'G'</span>, <span class="string">'B'</span>, <span class="string">'E'</span>, <span class="string">'F'</span>, <span class="string">'H'</span>, <span class="string">'I'</span>, <span class="string">'K'</span>, <span class="string">'L'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'V'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>]</div><div class="line">[<span class="string">'L'</span>, <span class="string">'I'</span>, <span class="string">'V'</span>, <span class="string">'E'</span>, <span class="string">'A'</span>, <span class="string">'N'</span>, <span class="string">'D'</span>, <span class="string">'R'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'K'</span>, <span class="string">'M'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'S'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>]</div><div class="line">[<span class="string">'S'</span>, <span class="string">'L'</span>, <span class="string">'I'</span>, <span class="string">'V'</span>, <span class="string">'E'</span>, <span class="string">'R'</span>, <span class="string">'A'</span>, <span class="string">'B'</span>, <span class="string">'C'</span>, <span class="string">'D'</span>, <span class="string">'F'</span>, <span class="string">'G'</span>, <span class="string">'H'</span>, <span class="string">'K'</span>, <span class="string">'M'</span>, <span class="string">'N'</span>, <span class="string">'O'</span>, <span class="string">'P'</span>, <span class="string">'Q'</span>, <span class="string">'T'</span>, <span class="string">'U'</span>, <span class="string">'W'</span>, <span class="string">'X'</span>, <span class="string">'Y'</span>, <span class="string">'Z'</span>]</div></pre></td></tr></table></figure>
<ul>
<li>整理明文</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">arrangeText</span><span class="params">(message)</span>:</span></div><div class="line">    <span class="string">'''整理明文中的英文字符，并进行分组处理'''</span></div><div class="line">    temp = [ char.upper() <span class="keyword">for</span> char <span class="keyword">in</span> message <span class="keyword">if</span> char.isalpha() ]  <span class="comment"># 去除其他字符，保留英文字母并转化为大写</span></div><div class="line">    newMessage = []</div><div class="line">    <span class="keyword">while</span> temp:</div><div class="line">        <span class="keyword">if</span> len(temp) != <span class="number">1</span>:</div><div class="line">            <span class="keyword">if</span> temp[<span class="number">1</span>] == temp[<span class="number">0</span>]:</div><div class="line">                newMessage.append((temp[<span class="number">0</span>], <span class="string">'X'</span>))</div><div class="line">                temp = temp[<span class="number">1</span>:]  <span class="comment"># 相当于剔除已经分组成功的字母</span></div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                newMessage.append((temp[<span class="number">0</span>], temp[<span class="number">1</span>]))</div><div class="line">                temp = temp[<span class="number">2</span>:]</div><div class="line">        <span class="keyword">else</span>:  <span class="comment"># 如果分组只剩最后一个字母时</span></div><div class="line">            newMessage.append((temp[<span class="number">0</span>], <span class="string">'X'</span>))</div><div class="line">            <span class="keyword">break</span></div><div class="line">    <span class="keyword">return</span> newMessage</div><div class="line"></div><div class="line">print(arrangeText(<span class="string">'I love you.'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">[(<span class="string">'I'</span>, <span class="string">'L'</span>), (<span class="string">'O'</span>, <span class="string">'V'</span>), (<span class="string">'E'</span>, <span class="string">'Y'</span>), (<span class="string">'O'</span>, <span class="string">'U'</span>)]</div></pre></td></tr></table></figure>
<ul>
<li>对明文进行加密：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">encryptPlayFair</span><span class="params">(message, key, dup=<span class="number">0</span>)</span>:</span></div><div class="line">    <span class="string">'''对明文使用密钥进行加密'''</span></div><div class="line">    newMessage = arrangeText(message)</div><div class="line">    table = createTable(key, dup)</div><div class="line">    translated = []</div><div class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> newMessage:</div><div class="line">        <span class="comment"># 获取 a 和 b 的下标</span></div><div class="line">        index1, index2, flag = table.index(a), table.index(b), <span class="keyword">False</span></div><div class="line"></div><div class="line">        <span class="comment"># 创建 [[0, 1, 2, 3, 4], [5, 6, 7, 8, 9], [10, 11, 12, 13, 14], [15, 16, 17, 18, 19], [20, 21, 22, 23, 24]] ranged 区间列表</span></div><div class="line">        <span class="comment"># 判断 a 和 b 是否在同一行，如果在同一行，flag = True</span></div><div class="line">        ranged = list(map(list, zip(*([iter(range(<span class="number">25</span>))] * <span class="number">5</span>))))</div><div class="line">        <span class="keyword">for</span> group <span class="keyword">in</span> ranged:</div><div class="line">            <span class="keyword">if</span> index1 <span class="keyword">in</span> group <span class="keyword">and</span> index2 <span class="keyword">in</span> group:</div><div class="line">                flag = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="comment"># a 和 b 在同一列时</span></div><div class="line">        <span class="keyword">if</span> (index2 - index1) % <span class="number">5</span> == <span class="number">0</span>: <span class="comment"># </span></div><div class="line">            char1, char2 = table[(index1 + <span class="number">5</span>) % <span class="number">25</span>], table[(index2 + <span class="number">5</span>) % <span class="number">25</span>]</div><div class="line"></div><div class="line">        <span class="comment"># a 和 b 在同一行时</span></div><div class="line">        <span class="keyword">elif</span> flag:</div><div class="line">            <span class="keyword">if</span> index1 <span class="keyword">in</span> &#123;<span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">24</span>&#125;:</div><div class="line">                char1, char2 = table[index1 - <span class="number">4</span>], table[index1 + <span class="number">1</span>]</div><div class="line">            <span class="keyword">elif</span> index2 <span class="keyword">in</span> &#123;<span class="number">4</span>, <span class="number">9</span>, <span class="number">14</span>, <span class="number">19</span>, <span class="number">24</span>&#125;:</div><div class="line">                char1, char2 = table[index1 + <span class="number">1</span>], table[index2 - <span class="number">4</span>]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                char1, char2 = table[index1 + <span class="number">1</span>], table[index2 + <span class="number">1</span>]</div><div class="line"></div><div class="line">        <span class="comment"># a 和 b 既不在同一行也不在同一列时</span></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            length1, length2 = index1 % <span class="number">5</span>, index2 % <span class="number">5</span></div><div class="line">            length = abs(length2 - length1)</div><div class="line">            <span class="keyword">if</span> length1 &gt; length2:</div><div class="line">                char1, char2 = table[index1 - length], table[index2 + length]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                char1, char2 = table[index1 + length], table[index2 - length]</div><div class="line">        </div><div class="line">        translated.append(char1 + char2)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(translated)</div><div class="line"></div><div class="line">print(encryptPlayFair(<span class="string">'I love you.'</span>, <span class="string">'Sliver'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">VIQLVZNW</div></pre></td></tr></table></figure>
<ul>
<li>对密文进行解密：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">decryptPlayFair</span><span class="params">(message, key, dup=<span class="number">0</span>)</span>:</span></div><div class="line">    <span class="string">'''对密文使用密钥进行解密'''</span></div><div class="line">    </div><div class="line">    <span class="comment"># 大部分思路与加密相同</span></div><div class="line">    messageGroups = list(zip(*([iter(<span class="string">'VIQLVZNW'</span>)] * <span class="number">2</span>)))</div><div class="line">    table = createTable(key, dup)</div><div class="line">    translated = []</div><div class="line">    <span class="keyword">for</span> a, b <span class="keyword">in</span> messageGroups:</div><div class="line">        index1, index2, flag = table.index(a), table.index(b), <span class="keyword">False</span></div><div class="line"></div><div class="line">        ranged = list(map(list, zip(*([iter(range(<span class="number">25</span>))] * <span class="number">5</span>))))</div><div class="line">        <span class="keyword">for</span> group <span class="keyword">in</span> ranged:</div><div class="line">            <span class="keyword">if</span> index1 <span class="keyword">in</span> group <span class="keyword">and</span> index2 <span class="keyword">in</span> group:</div><div class="line">                flag = <span class="keyword">True</span></div><div class="line"></div><div class="line">        <span class="keyword">if</span> (index2 - index1) % <span class="number">5</span> == <span class="number">0</span>:</div><div class="line">            char1, char2 = table[(index1 - <span class="number">5</span>) % <span class="number">25</span>], table[(index2 - <span class="number">5</span>) % <span class="number">25</span>]</div><div class="line"></div><div class="line">        <span class="keyword">elif</span> flag:</div><div class="line">            <span class="keyword">if</span> index1 <span class="keyword">in</span> &#123;<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>&#125;:</div><div class="line">                char1, char2 = table[index1 + <span class="number">4</span>], table[index1 - <span class="number">1</span>]</div><div class="line">            <span class="keyword">elif</span> index2 <span class="keyword">in</span> &#123;<span class="number">0</span>, <span class="number">5</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>&#125;:</div><div class="line">                char1, char2 = table[index1 - <span class="number">1</span>], table[index2 + <span class="number">4</span>]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                char1, char2 = table[index1 - <span class="number">1</span>], table[index2 - <span class="number">1</span>]</div><div class="line"></div><div class="line">        <span class="keyword">else</span>:</div><div class="line">            length1, length2 = index1 % <span class="number">5</span>, index2 % <span class="number">5</span></div><div class="line">            length = abs(length2 - length1)</div><div class="line">            <span class="keyword">if</span> length1 &gt; length2:</div><div class="line">                char1, char2 = table[index1 - length], table[index2 + length]</div><div class="line">            <span class="keyword">else</span>:</div><div class="line">                char1, char2 = table[index1 + length], table[index2 - length]</div><div class="line">        </div><div class="line">        translated.append(char1 + char2)</div><div class="line"></div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(translated)</div><div class="line"></div><div class="line">print(decryptPlayFair(<span class="string">'VIQLVZNW'</span>, <span class="string">'Sliver'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">ILOVEYOU</div></pre></td></tr></table></figure>
<h2 id="换位加密法"><a href="#换位加密法" class="headerlink" title="换位加密法"></a>换位加密法</h2><p>以上的加密法，其实都是将字母进行移位或替换来进行加密的。而换位加密法不是把字符替换成其他字符，而是搞乱消息符号的顺序，使原来的消息不可读。</p>
<p>从最简单的换位加密法来说，我们可以先拿 <code>Common sense is not so common.</code> 这个明文进行练手。在这里，先选择一个数字密钥 <code>8</code>。</p>
<p>我们创建一个 <code>4</code> 行 <code>8</code> 列的明文表格，这是根据 <code>row = len(message) // key + 1; col = key</code> 得出的，不全的地方不填充：</p>
<table>
<thead>
<tr>
<th style="text-align:center">C</th>
<th style="text-align:center">o</th>
<th style="text-align:center">m</th>
<th style="text-align:center">m</th>
<th style="text-align:center">o</th>
<th style="text-align:center">n</th>
<th style="text-align:center"></th>
<th style="text-align:center">s</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">e</td>
<td style="text-align:center">n</td>
<td style="text-align:center">s</td>
<td style="text-align:center">e</td>
<td style="text-align:center"></td>
<td style="text-align:center">i</td>
<td style="text-align:center">s</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">n</td>
<td style="text-align:center">o</td>
<td style="text-align:center">t</td>
<td style="text-align:center"></td>
<td style="text-align:center">s</td>
<td style="text-align:center">o</td>
<td style="text-align:center"></td>
<td style="text-align:center">c</td>
</tr>
<tr>
<td style="text-align:center">o</td>
<td style="text-align:center">m</td>
<td style="text-align:center">m</td>
<td style="text-align:center">o</td>
<td style="text-align:center">n</td>
<td style="text-align:center">.</td>
<td style="text-align:center">✖️</td>
<td style="text-align:center">✖️</td>
</tr>
</tbody>
</table>
<p>根据表格，我们选择每一列的字母，再见每一列的字母拼接，就是我们加密好的密文了，即 <code>Cenoonommstmme oo snnio. s s c</code>。</p>
<p>解密时，只需要将刚才的表格反转一下，再按列取字母拼接即可：</p>
<table>
<thead>
<tr>
<th style="text-align:center">C</th>
<th style="text-align:center">e</th>
<th style="text-align:center">n</th>
<th style="text-align:center">o</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">o</td>
<td style="text-align:center">n</td>
<td style="text-align:center">o</td>
<td style="text-align:center">m</td>
</tr>
<tr>
<td style="text-align:center">m</td>
<td style="text-align:center">s</td>
<td style="text-align:center">t</td>
<td style="text-align:center">m</td>
</tr>
<tr>
<td style="text-align:center">m</td>
<td style="text-align:center">e</td>
<td style="text-align:center"></td>
<td style="text-align:center">o</td>
</tr>
<tr>
<td style="text-align:center">o</td>
<td style="text-align:center"></td>
<td style="text-align:center">s</td>
<td style="text-align:center">n</td>
</tr>
<tr>
<td style="text-align:center">n</td>
<td style="text-align:center">i</td>
<td style="text-align:center">o</td>
<td style="text-align:center">.</td>
</tr>
<tr>
<td style="text-align:center"></td>
<td style="text-align:center">s</td>
<td style="text-align:center"></td>
<td style="text-align:center">✖️</td>
</tr>
<tr>
<td style="text-align:center">s</td>
<td style="text-align:center"></td>
<td style="text-align:center">c</td>
<td style="text-align:center">✖️</td>
</tr>
</tbody>
</table>
<p>可得到明文为：<code>Common sense is not so common.</code></p>
<ul>
<li>加密代码实现：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TranspositionEncrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 明文</span></div><div class="line"><span class="string">    key: 密钥（推荐是小于明文一半长度的数字）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    cipherrext = [<span class="string">''</span>] * key  <span class="comment"># 创建密文列表，里面包含 key 个列，先用空字符初始化</span></div><div class="line">    <span class="keyword">for</span> col <span class="keyword">in</span> range(key):</div><div class="line">        index = col</div><div class="line">        <span class="keyword">while</span> index &lt; len(message):</div><div class="line">            cipherrext[col] += message[index]  <span class="comment"># 相当与构建了 key 列 (len(message) // key + 1) 行的二维表格，每次取同一列的数据</span></div><div class="line">            index += key</div><div class="line">    <span class="keyword">return</span> <span class="string">'['</span> + <span class="string">''</span>.join(cipherrext) + <span class="string">']'</span>  <span class="comment"># 防止看不清尾部可能存在的空格，所以加上中括号进行包围</span></div><div class="line"></div><div class="line">print(TranspositionEncrypt(<span class="string">'When I see you again.'</span>, <span class="number">8</span>))</div><div class="line">print(TranspositionEncrypt(<span class="string">'Common sense is not so common.'</span>, <span class="number">8</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[Wegheae inyn o.Iu  sa]</div><div class="line">[Cenoonommstmme oo snnio. s s c]</div></pre></td></tr></table></figure>
<ul>
<li>解密代码实现：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">TranspositionDecrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 密文</span></div><div class="line"><span class="string">    key: 密钥（推荐是小于明文一半长度的数字）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    numOfColumns, numOfRows = len(message) // key + <span class="number">1</span>, key</div><div class="line">    numOfShadedBoxex = numOfColumns * numOfRows - len(message)</div><div class="line">    plaintext = [<span class="string">''</span>] * numOfColumns</div><div class="line">    col, row = <span class="number">0</span>, <span class="number">0</span></div><div class="line">    <span class="keyword">for</span> symbol <span class="keyword">in</span> message:</div><div class="line">        plaintext[col] += symbol</div><div class="line">        col += <span class="number">1</span></div><div class="line">        <span class="keyword">if</span> (col == numOfColumns) <span class="keyword">or</span> (col == numOfColumns - <span class="number">1</span> <span class="keyword">and</span> row &gt;= numOfRows - numOfShadedBoxex):</div><div class="line">            row, col = row + <span class="number">1</span>, <span class="number">0</span></div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(plaintext)</div><div class="line"></div><div class="line">print(TranspositionDecrypt(<span class="string">'Wegheae inyn o.Iu  sa'</span>, <span class="number">8</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">When I see you again.</div><div class="line">Common sense <span class="keyword">is</span> <span class="keyword">not</span> so common.</div></pre></td></tr></table></figure>
<p>也可以根据给定的置换进行换位加密，比如给定一个置换密钥对明文 <code>Hide the gold in the tree stump.</code> 进行加密：</p>
<table>
<thead>
<tr>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">2</td>
<td style="text-align:center">5</td>
<td style="text-align:center">8</td>
<td style="text-align:center">6</td>
<td style="text-align:center">1</td>
<td style="text-align:center">3</td>
<td style="text-align:center">7</td>
<td style="text-align:center">4</td>
</tr>
</tbody>
</table>
<p>首先需要将明文按照密钥的长度进行分组，即每组八个，不足八个就拿一开始的字母去凑，比如上面的明文可以整理成 <code>[&#39;Hide the&#39;] [&#39; gold in&#39;] [&#39; the tre&#39;] [&#39;e stump.&#39;]</code> 四组。</p>
<p>根据所给的置换密钥，对第一组数据，相当于是让原本是位置是第二个的字符，现在放在第一个，原本是第五个位置的字符，现在放在第二个…所以 <code>[&#39;Hide the&#39;]</code> 转化为 <code>[&#39;i etHdh&#39;]</code>，<code>[&#39; gold in&#39;]</code> 转化为 <code>[&#39;egdn  oi&#39;]</code>。</p>
<p>将所有置换后的字符拼接起来，可以得到加密密文：<code>i etHdhegdn  oilt et hre u.mespt</code></p>
<p>解密时，我们根据密钥求逆置换密钥，也就是：</p>
<table>
<thead>
<tr>
<th style="text-align:center">1</th>
<th style="text-align:center">2</th>
<th style="text-align:center">3</th>
<th style="text-align:center">4</th>
<th style="text-align:center">5</th>
<th style="text-align:center">6</th>
<th style="text-align:center">7</th>
<th style="text-align:center">8</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">5</td>
<td style="text-align:center">1</td>
<td style="text-align:center">6</td>
<td style="text-align:center">8</td>
<td style="text-align:center">2</td>
<td style="text-align:center">4</td>
<td style="text-align:center">7</td>
<td style="text-align:center">3</td>
</tr>
</tbody>
</table>
<p>重复分组，分别置换，即可得到明文：<code>Hide the gold in the tree stump.</code></p>
<ul>
<li>加密代码实现：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">PermutationEncrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 明文</span></div><div class="line"><span class="string">    key: 密钥（是一个数字字符串，里面的数字是连续的，但是位置是打乱的，如'25861374'）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    newMessage = [char <span class="keyword">for</span> char <span class="keyword">in</span> message]  <span class="comment"># 不想保留其他字符时，可以改成：[char for char in message if char.isalpha()]</span></div><div class="line">    numOfChars, numOfGroups = len(key), len(newMessage) // len(key) + <span class="number">1</span></div><div class="line">    blanks = numOfGroups * len(key) - len(newMessage)  <span class="comment"># 计算出分组不足的空间</span></div><div class="line">    <span class="keyword">if</span> blanks &lt; len(key):</div><div class="line">        newMessage += newMessage[:blanks]  <span class="comment"># 用前面的字母进行补全以完成接下来分组</span></div><div class="line">    groups = list(map(list, zip(*[iter(newMessage)] * len(key))))  <span class="comment"># 按每组长度为 len(key) 进行分组</span></div><div class="line">    temp = []</div><div class="line">    <span class="keyword">for</span> group <span class="keyword">in</span> groups:</div><div class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> key:</div><div class="line">            temp.append(group[int(index) - <span class="number">1</span>])  <span class="comment"># 根据置换密钥进行置换加密</span></div><div class="line">    <span class="keyword">return</span> <span class="string">'['</span> + <span class="string">''</span>.join(temp) + <span class="string">']'</span>  <span class="comment"># 防止看不清尾部可能存在的空格，所以加上中括号进行包围</span></div><div class="line"></div><div class="line">print(PermutationEncrypt(<span class="string">'Hide the gold in the tree stump.'</span>, key = <span class="string">'25861374'</span>))</div><div class="line">print(PermutationEncrypt(<span class="string">'I hid the gold in the kitchen.'</span>, key = <span class="string">'25861374'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">[i etHdhegdn  oilt et hre u.mespt]</div><div class="line">[ dh Ihti lideg o ei ntkhcn .thIe]</div></pre></td></tr></table></figure>
<ul>
<li>解密代码实现：</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">inversePermutation</span><span class="params">(key)</span>:</span></div><div class="line">    <span class="string">'''根据给定 key 求它的逆置换'''</span></div><div class="line">    <span class="comment"># 先根据给定的 key 创建映射，如 key = '25861374' 时，创建的映射为：&#123;'2': 1, '5': 2, '8': 3, '6': 4, '1': 5, '3': 6, '7': 7, '4': 8&#125;</span></div><div class="line">    dictMap = &#123;k: v <span class="keyword">for</span> k, v <span class="keyword">in</span> zip(key, range(<span class="number">1</span>, len(key) + <span class="number">1</span>))&#125;</div><div class="line">    <span class="comment"># 根据键排序，按上面的例子可以得到：[('1', 5), ('2', 1), ('3', 6), ('4', 8), ('5', 2), ('6', 4), ('7', 7), ('8', 3)]</span></div><div class="line">    sortedMap = sorted(dictMap.items(), key=<span class="keyword">lambda</span> x: x[<span class="number">0</span>])</div><div class="line">    <span class="comment"># 得到排序好后的映射的值，也就是逆置换：['5', '1', '6', '8', '2', '4', '7', '3']</span></div><div class="line">    inverse = [str(item[<span class="number">1</span>]) <span class="keyword">for</span> item <span class="keyword">in</span> sortedMap]</div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(inverse)  <span class="comment"># 将逆转置列表转化为字符串</span></div><div class="line"></div><div class="line">print(inversePermutation(<span class="string">'25861374'</span>))</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">def</span> <span class="title">PermutationDecrypt</span><span class="params">(message, key)</span>:</span></div><div class="line">    <span class="string">'''</span></div><div class="line"><span class="string">    message: 密文</span></div><div class="line"><span class="string">    key: 密钥（是一个数字字符串，里面的数字是连续的，但是位置是打乱的，如'25861374'）</span></div><div class="line"><span class="string">    '''</span></div><div class="line">    inverseKey = inversePermutation(key)</div><div class="line">    newMessage = list(map(list, zip(*[iter(message)] * len(inverseKey))))</div><div class="line">    temp = []</div><div class="line">    <span class="keyword">for</span> group <span class="keyword">in</span> newMessage:</div><div class="line">        <span class="keyword">for</span> index <span class="keyword">in</span> inverseKey:</div><div class="line">            temp.append(group[int(index) - <span class="number">1</span>])</div><div class="line">    <span class="keyword">return</span> <span class="string">''</span>.join(temp)</div><div class="line"></div><div class="line">print(PermutationDecrypt(<span class="string">'i etHdhegdn  oilt et hre u.mespt'</span>, <span class="string">'25861374'</span>))</div><div class="line">print(PermutationDecrypt(<span class="string">' dh Ihti lideg o ei ntkhcn .thIe'</span>, <span class="string">'25861374'</span>))</div></pre></td></tr></table></figure>
<p>输出结果为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">Hide the gold <span class="keyword">in</span> the tree stump.</div><div class="line">I hid the gold <span class="keyword">in</span> the kitchen.I</div></pre></td></tr></table></figure>
<p>因为涉及补全字符的问题，所以输出结果跟原明文相比可能会多出几个字符。</p>
<h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ul>
<li><a href="https://baike.baidu.com/item/%E5%AF%86%E7%A0%81%E5%AD%A6" target="_blank" rel="external">百度百科</a></li>
<li><a href="https://book.douban.com/subject/19986936/" target="_blank" rel="external">深入浅出密码学</a></li>
<li><a href="https://book.douban.com/subject/26869300/" target="_blank" rel="external">Python密码学编程</a></li>
<li><a href="http://blog.csdn.net/DLPointer/article/details/62891638" target="_blank" rel="external">Playfair密码(C语言实现)</a></li>
<li><a href="http://blog.csdn.net/white_idiot/article/details/61201864" target="_blank" rel="external">(密码学)维吉尼亚密码加解密原理及其破解算法Java实现</a></li>
</ul>

      
    </div>
    
    
    

    

    
      <div>
        <div style="padding: 10px 0; margin: 20px auto; width: 90%; text-align: center;">
  <div></div>
  <button id="rewardButton" disable="enable" onclick="var qr = document.getElementById('QR'); if (qr.style.display === 'none') {qr.style.display='block';} else {qr.style.display='none'}">
    <span>打赏</span>
  </button>
  <div id="QR" style="display: none;">

    

    
      <div id="alipay" style="display: inline-block">
        <img id="alipay_qr" src="/assets/img/alipay.jpg" alt="Sliver 支付宝"/>
        <p>支付宝</p>
      </div>
    

    

  </div>
</div>

      </div>
    

    
      <div>
        <ul class="post-copyright">
  <li class="post-copyright-author">
    <strong>本文作者：</strong>
    Sliver
  </li>
  <li class="post-copyright-link">
    <strong>本文链接：</strong>
    <a href="http://home.junyouxiaowu.top/2018/03/05/Python密码学1/" title="Python密码学不完全指北（古典密码）">http://home.junyouxiaowu.top/2018/03/05/Python密码学1/</a>
  </li>
  <li class="post-copyright-license">
    <strong>版权声明： </strong>
    本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/3.0/" rel="external nofollow" target="_blank">CC BY-NC-SA 3.0</a> 许可协议。转载请注明出处！
  </li>
</ul>

      </div>
    

    <footer class="post-footer">
      
        <div class="post-tags">
          
            <a href="/tags/Python/" rel="tag"><i class="fa fa-envira" aria-hidden="true"></i> Python</a>
          
            <a href="/tags/Tips/" rel="tag"><i class="fa fa-envira" aria-hidden="true"></i> Tips</a>
          
            <a href="/tags/Cryptography/" rel="tag"><i class="fa fa-envira" aria-hidden="true"></i> Cryptography</a>
          
        </div>
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/2018/03/04/番茄工作法总结/" rel="next" title="番茄工作法总结">
                <i class="fa fa-chevron-left"></i> 番茄工作法总结
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/2018/03/15/区块链简明教程/" rel="prev" title="区块链入门简明教程">
                区块链入门简明教程 <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
        
<!--MOB SHARE BEGIN-->
<div class="-mob-share-ui-button -mob-share-open" style="background: #c7c7c3">分享</div>
<div class="-mob-share-ui" style="display: none">
    <ul class="-mob-share-list">
        <li class="-mob-share-weibo"><p>新浪微博</p></li>
        <li class="-mob-share-tencentweibo"><p>腾讯微博</p></li>
        <li class="-mob-share-qzone"><p>QQ空间</p></li>
        <li class="-mob-share-qq"><p>QQ好友</p></li>
        <li class="-mob-share-weixin"><p>微信</p></li>
        <li class="-mob-share-douban"><p>豆瓣</p></li>
        <li class="-mob-share-renren"><p>人人网</p></li>
        <li class="-mob-share-kaixin"><p>开心网</p></li>
        <li class="-mob-share-facebook"><p>Facebook</p></li>
        <li class="-mob-share-twitter"><p>Twitter</p></li>
        <li class="-mob-share-pocket"><p>Pocket</p></li>
        <li class="-mob-share-google"><p>Google+</p></li>
        <li class="-mob-share-youdao"><p>有道云笔记</p></li>
        <li class="-mob-share-mingdao"><p>明道</p></li>
        <li class="-mob-share-pengyou"><p>朋友网</p></li>
        <li class="-mob-share-tumblr"><p>Tumblr</p></li>
        <li class="-mob-share-instapaper"><p>Instapaper</p></li>
        <li class="-mob-share-linkedin"><p>LinkedIn</p></li>
    </ul>
    <div class="-mob-share-close">取消</div>
</div>
<div class="-mob-share-ui-bg"></div>
<script id="-mob-share" src="http://f1.webshare.mob.com/code/mob-share.js?appkey=25d756501c920"></script>
<!--MOB SHARE END-->

      
    </div>
  </div>


          </div>
          


          

  
    <div class="comments" id="comments">
      <div id="lv-container" data-id="city" data-uid="MTAyMC8zMjcxNC85Mjc1"></div>
    </div>

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/assets/img/head.jpg"
                alt="Sliver" />
            
              <p class="site-author-name" itemprop="name">Sliver</p>
              <p class="site-description motion-element" itemprop="description">春风十里，不如你。</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">54</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                <a href="/categories/index.html">
                  <span class="site-state-item-count">11</span>
                  <span class="site-state-item-name">分类</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">27</span>
                  <span class="site-state-item-name">标签</span>
                </a>
              </div>
            

          </nav>

          
            <div class="feed-link motion-element">
              <a href="/atom.xml" rel="alternate">
                <i class="fa fa-rss"></i>
                RSS
              </a>
            </div>
          

          <div class="links-of-author motion-element">
            
              
                <span class="links-of-author-item">
                  <a href="https://github.com/SliverYou" target="_blank" title="GitHub">
                    
                      <i class="fa fa-fw fa-github"></i>GitHub</a>
                </span>
              
                <span class="links-of-author-item">
                  <a href="https://www.zhihu.com/people/wang-chuan-50-11/activities" target="_blank" title="知乎">
                    
                      <i class="fa fa-fw fa-pencil-square-o"></i>知乎</a>
                </span>
              
            
          </div>

          
          

          
          
            <div class="links-of-blogroll motion-element links-of-blogroll-block">
              <div class="links-of-blogroll-title">
                <i class="fa  fa-fw fa-link"></i>
                Links
              </div>
              <ul class="links-of-blogroll-list">
                
                  <li class="links-of-blogroll-item">
                    <a href="http://blog.0x1024.top/" title="Holen" target="_blank">Holen</a>
                  </li>
                
              </ul>
            </div>
          

          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#什么是密码学？"><span class="nav-number">1.</span> <span class="nav-text">什么是密码学？</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#凯撒加密法"><span class="nav-number">2.</span> <span class="nav-text">凯撒加密法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#维吉尼亚加密法"><span class="nav-number">3.</span> <span class="nav-text">维吉尼亚加密法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#使用维吉尼亚加密法对信息进行加密和解密"><span class="nav-number">3.1.</span> <span class="nav-text">使用维吉尼亚加密法对信息进行加密和解密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#爆破维吉尼亚加密法"><span class="nav-number">3.2.</span> <span class="nav-text">爆破维吉尼亚加密法</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#仿射加密法"><span class="nav-number">4.</span> <span class="nav-text">仿射加密法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#Playfair-加密法"><span class="nav-number">5.</span> <span class="nav-text">Playfair 加密法</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#加密"><span class="nav-number">5.1.</span> <span class="nav-text">加密</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#编制密码表"><span class="nav-number">5.1.1.</span> <span class="nav-text">编制密码表</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#整理明文"><span class="nav-number">5.1.2.</span> <span class="nav-text">整理明文</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#编写密文"><span class="nav-number">5.1.3.</span> <span class="nav-text">编写密文</span></a></li></ol></li><li class="nav-item nav-level-3"><a class="nav-link" href="#解密"><span class="nav-number">5.2.</span> <span class="nav-text">解密</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#换位加密法"><span class="nav-number">6.</span> <span class="nav-text">换位加密法</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#参考资料"><span class="nav-number">7.</span> <span class="nav-text">参考资料</span></a></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; 2017 &mdash; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Sliver</span>

  
</div>


  <div class="powered-by">import <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> </div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">class&nbsp<a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">Muse</a> v5.1.3</div>




<div class="footer-custom">
  <span>Hosted by <a href="https://pages.coding.me" style="font-weight: bold">Coding Pages</a></span>
</div>


        
<div class="busuanzi-count">
  <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js"></script>

  
    <span class="site-uv">
      <i class="fa fa-paw"></i> 访问人数
      <span class="busuanzi-value" id="busuanzi_value_site_uv"></span>
      
    </span>
  

  
    <span class="site-pv">
      <i class="fa fa-camera"></i> 总访问量
      <span class="busuanzi-value" id="busuanzi_value_site_pv"></span>
      
    </span>
  
</div>








        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
          <span id="scrollpercent"><span>0</span>%</span>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  




  
  









  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three.min.js"></script>
  

  
  
    <script type="text/javascript" src="/lib/three/three-waves.min.js"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  
    <script type="text/javascript">
      (function(d, s) {
        var j, e = d.getElementsByTagName(s)[0];
        if (typeof LivereTower === 'function') { return; }
        j = d.createElement(s);
        j.src = 'https://cdn-city.livere.com/js/embed.dist.js';
        j.async = true;
        e.parentNode.insertBefore(j, e);
      })(document, 'script');
    </script>
  












  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.xml";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  
  

  

  

  

  
  
    <canvas class="fireworks" style="position: fixed;left: 0;top: 0;z-index: 1; pointer-events: none;" ></canvas> 
    <script type="text/javascript" src="//cdn.bootcss.com/animejs/2.2.0/anime.min.js"></script> 
    <script type="text/javascript" src="/js/src/fireworks.js"></script>
  

  
    <a href="https://github.com/SliverYou" class="github-corner" aria-label="View source on Github"><svg width="80" height="80" viewBox="0 0 250 250" style="fill:#70B7FD; color:#fff; position: absolute; top: 0; border: 0; right: 0;" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><style>.github-corner:hover .octo-arm{animation:octocat-wave 560ms ease-in-out}@keyframes octocat-wave{0%,100%{transform:rotate(0)}20%,60%{transform:rotate(-25deg)}40%,80%{transform:rotate(10deg)}}@media (max-width:500px){.github-corner:hover .octo-arm{animation:none}.github-corner .octo-arm{animation:octocat-wave 560ms ease-in-out}}</style>
  

</body>
</html>